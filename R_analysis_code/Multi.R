setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")

colfunc<-colorRampPalette(c("orange","cyan"))
cc_eff<-colfunc(4)

#ff1<-list.files("SLiM_output")[grep(".txt",list.files("SLiM_output"))][29]
#ff2<-list.files("SLiM_output")[grep(".txt",list.files("SLiM_output"))][33]

#freq1<-read.table(paste("SLiM_output/",ff1,sep=""))
#freq2<-read.table(paste("SLiM_output/",ff2,sep=""))

freq1<-read.table("SLiM_output/Freq_MM_100_1593909929523_Gen500.txt")
freq2<-read.table("SLiM_output/Freq_MM_100_1593909929523_Gen1000.txt")

names<-c("Effect",paste("P",1:100, sep=""))
names2<-c("Effect2",rep(paste("A",1:10, sep=""),10))

fff1 <- cbind(names,names2,freq1)
fff2 <- cbind(names,names2,freq2)

fff1$names<-factor(fff1$names,levels=unique(fff1$names))
fff1$names2<-factor(fff1$names2,levels=unique(fff1$names2))

fff2$names<-factor(fff2$names,levels=unique(fff2$names))
fff2$names2<-factor(fff2$names2,levels=unique(fff2$names2))


fs1<-rowsum(fff1[-1,-c(1:3)],fff1$names2[-1])

fs2<-rowsum(fff2[-1,-c(1:3)],fff2$names2[-1])
#Range of effect sizes
mm<-summary(as.vector(t(fff1[1,-c(1,2)])))
mmm<-mm[-3]


plot(fff1$V1[-1],fff1[-1,4],lwd=0.5,cex=1,pch=21,xlab="Optima",ylab="Mutant allele frequency",col="black",bg=hsv(0.12,abs(fff1[1,4]/mmm[1])),ylim=c(0,1))
for(i in 5:ncol(fff1)){
  if (fff1[1,i]<0){
      points(fff1$V1[-1],fff1[-1,i],lwd=0.5,cex=1,pch=21,col="black",bg=hsv(0.12,abs(fff1[1,i]/mmm[1])))
  }else{
    points(fff1$V1[-1],fff1[-1,i],lwd=0.5,cex=1,pch=21,col="black",bg=hsv(0.5,abs(fff1[1,i]/mmm[5])))
  }
}

plot(fff1[-1,4], type="l",lwd=2,xlab="Optima",ylab="Mutant allele frequency",col=hsv(0.12,abs(fff1[1,4]/mmm[5])),ylim=c(0,1))
for(i in 5:ncol(fff1)){
  if (fff1[1,i]<0){
    lines(fff1[-1,i],lwd=2,col=hsv(0.12,abs(fff1[1,i]/mmm[1])))
  }else{
    lines(fff1[-1,i],lwd=2,col=hsv(0.5,abs(fff1[1,i]/mmm[5])))
  }
}

plot(fs1$V2, type="l",lwd=2,xlab="Optima",ylab="Mutant allele frequency",col=hsv(0.12,sum(fs1$V2)+0.5),ylim=c(0,4))
for(i in 2:ncol(fs1)){
    lines(fs1[,i],lwd=2,col="green")
}

plot(fs2$V2, type="l",lwd=2,xlab="Optima",ylab="Mutant allele frequency",col=hsv(0.12,sum(fs2$V2)+0.5),ylim=c(0,4))
for(i in 2:ncol(fs2)){
  lines(fs2[,i],lwd=2,col="green")
}
mm<-summary(as.vector(t(fff2[1,-c(1,2)])))
mmm<-mm[-3]

plot(fff2[-1,4], type="l",lwd=2,xlab="Optima",ylab="Mutant allele frequency",col=hsv(0.12,abs(fff2[1,4]/mmm[5])),ylim=c(0,1))
for(i in 5:ncol(fff2)){
  if (fff2[1,i]<0){
    lines(fff2[-1,i],lwd=2,col=hsv(0.12,abs(fff2[1,i]/mmm[1])))
  }else{
    lines(fff2[-1,i],lwd=2,col=hsv(0.5,abs(fff2[1,i]/mmm[5])))
  }
}

plot(fff2$V1[-1],fff2[-1,4], pch=19,xlab="Optima",ylab="Mutant allele frequency",col=cc_eff[length(which(fff2[1,4]>mmm))],ylim=c(0,1))
for(i in 5:ncol(fff2)){
  points(fff2$V1[-1],fff2[-1,i],pch=19,col=cc_eff[length(which(fff2[1,i]>mmm))])
}

plot(fff2$V1[-1],fff2[-1,4], lwd=0.5,cex=1,pch=21,xlab="Optima",ylab="Mutant allele frequency",col="black",bg=hsv(0.12,abs(fff2[1,4]/mmm[1])),ylim=c(0,1))
for(i in 5:ncol(fff2)){
  if (fff2[1,i]<0){
    points(fff2$V1[-1]+runif(1,0,0.05),fff2[-1,i],lwd=0.5,cex=1,pch=21,col="black",bg=hsv(0.12,abs(fff2[1,i]/mmm[1])))
  }else{
    points(fff2$V1[-1]+runif(1,0,0.05),fff2[-1,i],lwd=0.5,cex=1,pch=21,col="black",bg=hsv(0.5,abs(fff2[1,i]/mmm[5])))
  }
}
    
