setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/TSR_output/")

require(ggplot2)
require(reshape2)
require(RColorBrewer)

#load("T2_m0.05.RData")

colfunc<-colorRampPalette(c("orange","cyan"))

cg<-read.table("CG_SP_100_1581160262936_Gen300.txt",header=F)

colnames(cg)<-rep(paste("H",seq(1:10),sep=""),10)
cg$Transplant<-rep(paste("T",seq(1:10),sep=""),10)

# gfcg<-rep(paste("T",seq(1:10),sep=""),10)
# for(i in envPop$envSelect){
#   envPop_t<-data.frame((rep(i,100)))
#   colnames(envPop_t)<-"envSelect"
#   gfcg <- cbind(gfcg,predict(gfMod, envPop_t))
# }


#cg$D_CI<-offset$D_C.Imp_genome

CI_bf <- gfTrans1$C.Imp_genome_before[1:10]

CI<-NULL
for(i in 1:length(CI_bf)){
  for(j in 1:length(CI_bf)){
    CI<-c(CI,CI_bf[j]-CI_bf[i])
  }
}

CI_rep<-NULL
for (i in seq(1,100,10)){
  CI_rep<-c(CI_rep,rep(CI[i:(i+9)],10))
}


#cg$D_CI<-CI

cg_df <- melt(cg,  id.vars ="Transplant",  variable.name = "Home", 
              value.name = "Fitness")

cg_df$Transplant<-factor(cg_df$Transplant,levels=cg_df$Transplant[1:10])

cg_df$D_CI<-CI_rep

ggplot(data=cg_df,aes(x=cg_df$Fitness, y=cg_df$D_CI, colour=cg_df$Transplant))+
  geom_line()+
  geom_point(aes(shape=cg_df$Home), size=3)+
  labs(shape="Genotype", colour="Common\nGarden\nLocation")+
  scale_color_manual(values = colfunc(10))+
  scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
  xlab("Relative Fitness at end of burnin")+
  ylab("GF Offset")

ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
  geom_line()+
  geom_point(aes(shape=cg_df$Home), size=3)+
  labs(shape="Genotype", colour="Common\nGarden\nLocation")+
  scale_color_manual(values = colfunc(10))+
  scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
  xlab("Relative Fitness at end of burnin")+
  ylab("Absolute GF Offset")

#expression(paste(Delta,




        