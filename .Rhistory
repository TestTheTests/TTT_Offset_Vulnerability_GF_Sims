require(grid)
require(gridExtra)
require(gtools)
require(stringr)
require(reshape2)
require(hierfstat)
setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")
list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))]
#seed = 7518873473629
f1<-list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))][13]
(seed<-substr(f1, start=1, stop=13))
#fit<-read.table(paste("Fit_SP_100_",seed,".txt",sep=""),fill=T)
fit<-read.table(paste("results/SLiM_output/Sim_sum/",seed,"_Freq_ML_WF.txt",sep=""))
fit_nam <- NULL
for(i in 1:100){
fit_nam <- c(fit_nam,paste("P",i,"_fit",sep=""))
}
freq_nam <- NULL
for(i in 1:100){
freq_nam <- c(freq_nam,paste("P",i,"_freq",sep=""))
}
env_nam <- NULL
for(i in 1:100){
env_nam <- c(env_nam,paste("P",i,"_env",sep=""))
}
colnames(fit)<-c("m","n","u","r","mean_Eff", "var_Eff", "var_Opt", "Env_rate","Burnin","Env_shift", "Generation", fit_nam, freq_nam, env_nam)
N<-data.frame(fit$n[1]*100)
colnames(N)<-"N"
(specs<-data.frame(seed,fit[1,1:2],N,fit[1,3:7]))
View(fit)
require(ggplot2)
require(cowplot)
require(qqman)
require(RColorBrewer)
colfunc<-colorRampPalette(c("orange","cyan"))
#plot(c(1:10),rep(1,10),col=colfunc(10),pch=19,cex=5) #Get color gradients for matrix image
#fit[1,210:309]<-fit[2,210:309]
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-5,10))
specs
fit[1,1:10]
fit[1,1:11]
fit[1,1:10]
(specs<-data.frame(seed,fit[1,1:2],N,fit[1,3:10]))
colnames(specs)[8]
plotTitle <- paste(colnames(specs)[1],":",specs[[1]],", ", colnames(specs)[2],":",specs[2],", ",colnames(specs)[3],":",specs[3],", ",colnames(specs)[4],":",1e-7,",",colnames(specs)[5],":",specs[5],", ",colnames(specs)[6],":",specs[6],", ",colnames(specs)[7],":",specs[7],", ",colnames(specs)[8],":",specs[8],colnames(specs)[9],":",specs[9],colnames(specs)[10],":",specs[10],sep="")
plotTitle
plotTitle <- paste(colnames(specs)[1],":",specs[[1]],", ", colnames(specs)[2],":",specs[2],", ",colnames(specs)[3],":",specs[3],", ",colnames(specs)[4],":",1e-7,",",colnames(specs)[5],":",specs[5],", ",colnames(specs)[6],":",specs[6],", ",colnames(specs)[7],":",specs[7],", ",colnames(specs)[8],":",specs[8],", ",colnames(specs)[9],":",specs[9],", ",colnames(specs)[10],":",specs[10],sep="")
plotTitle
#plot(c(1:10),rep(1,10),col=colfunc(10),pch=19,cex=5) #Get color gradients for matrix image
#fit[1,210:309]<-fit[2,210:309]
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-5,10))
k=1
for(i in 209:308){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit[,209]
colnames(fit)[209]
colnames(fit)[2011]
colnames(fit)[201]
colnames(fit)[211]
colnames(fit)[212]
colnames(fit)[307]
colnames(fit)[308]
colnames(fit)[309]
colnames(fit)[310]
colnames(fit)[311]
colnames(fit)[312]
colnames(fit)[311]
?stringr
#plot(c(1:10),rep(1,10),col=colfunc(10),pch=19,cex=5) #Get color gradients for matrix image
#fit[1,210:309]<-fit[2,210:309]
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-5,10))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#plot(c(1:10),rep(1,10),col=colfunc(10),pch=19,cex=5) #Get color gradients for matrix image
#fit[1,210:309]<-fit[2,210:309]
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-1,1))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_fit,type="l",main=plotTitle ,xlab="Generations",ylab="Relative Fitness",col="red",ylim=c(min(fit[,c(9:108)]),max(fit[,c(9:108)])))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 9)
#print(k)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 9)
print(k)
#lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
fitt<-data.frame(t(fit[,-1:-17])) # For neutral simulation
fitt
View(fitt)
fit[,1:17]
fitt<-data.frame(t(fit[,-1:-10]))
fit[,1:11]
fitt<-data.frame(t(fit[,-1:-11]))
View(fitt)
gen_nam
gen_nam <- paste("Gen",fit$Generation,sep="")
colnames(fitt)<-gen_nam
fitt$Location <- as.factor(rep(paste("A",seq(1,10,1),sep=""),30))
fitt$Location <- factor(fitt$Location, levels = unique(fitt$Location))
fitt$Type <- as.factor(c(rep("Fit",100),rep("Freq",100),rep("Env",100)))
View(fitt)
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_fit,type="l",main=plotTitle ,xlab="Generations",ylab="Relative Fitness",col="red",ylim=c(min(fit[,c(9:108)]),max(fit[,c(9:108)])))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 9)
#print(k)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 9)
print(k)
#lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
fit[,9]
fit[,19]
View(fit)
fit$Gen
fit$P19_freq
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,1))
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,2))
list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))]
#seed = 7518873473629
f1<-list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))][15]
(seed<-substr(f1, start=1, stop=13))
#fit<-read.table(paste("Fit_SP_100_",seed,".txt",sep=""),fill=T)
fit<-read.table(paste("results/SLiM_output/Sim_sum/",seed,"_Freq_ML_WF.txt",sep=""))
fit_nam <- NULL
for(i in 1:100){
fit_nam <- c(fit_nam,paste("P",i,"_fit",sep=""))
}
freq_nam <- NULL
for(i in 1:100){
freq_nam <- c(freq_nam,paste("P",i,"_freq",sep=""))
}
View(fit)
env1_nam <- NULL
for(i in 1:100){
env1_nam <- c(env1_nam,paste("P",i,"_env1",sep=""))
}
env2_nam <- NULL
for(i in 1:100){
env2_nam <- c(env2_nam,paste("P",i,"_env2",sep=""))
}
colnames(fit)
colnames(fit)<-c("m","n","u","r","mean_Eff", "var_Eff", "var_Opt", "Env_rate","Burnin","Env_shift", "Generation", fit_nam, freq_nam, env1_nam, env2_nam)
View(fit)
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="white",ylim=c(-1,1))
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="red",ylim=c(-1,1))
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="red",ylim=c(-1,20))
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="red",ylim=c(-1,1))
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="white",ylim=c(-1,1))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable 1",col="white",ylim=c(-1,20))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,20))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,20))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit[,312]
colnames(fit)[312]
colnames(fit)[411]
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-20,20))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-20,20))
lines(fit$Gen,fit[,312],lwd=2,col=colfunc(10)[1])
lines(fit$Gen,fit[,313],lwd=2,col=colfunc(10)[2])
View(fit)
View(fit)
for(i in 312:411){
print(fit[,i])
#lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,1))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,20))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit$P19_env2
fit$Gen
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-20,20))
k=1
for(i in 312:411){
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
for(i in 312:411){
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,1))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,20))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit$P19_env2
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="black",ylim=c(-1,1))
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="black",ylim=c(-1,1))
fit$P1_env2
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="black",ylim=c(-1,1))
for(i in 312:411){
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
k=1
colfunc(10)
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="black",ylim=c(-1,1))
k=1
for(i in 312:411){
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
i=1
k=1
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
i=312
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
lines(fit$Gen,fit[,313],lwd=2,col=colfunc(10)[2])
fit[,312]
fit[,313]
fit[,314]
fit[,411]
fit[,410]
fit[,400]
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
for(i in 312:411){
print(i)
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,20))
k=1
for(i in 312:411){
print(i)
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit$Gen
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,20))
plot(fit$Gen,fit$P20_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="red",ylim=c(-1,20))
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="red",ylim=c(-1,20))
plot(fit$Gen,fit$P2_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="red",ylim=c(-1,20))
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="red",ylim=c(-1,20))
lines(fit$Gen,fit[,312])
lines(fit$Gen,fit[,313])
lines(fit$Gen,fit[,314])
lines(fit$Gen,fit[,329])
lines(fit$Gen,fit[,330])
for(i in 312:411){
print(i)
print(fit[,i])
lines(fit$Gen,fit[,i],lwd=1,col=colfunc(10)[k])
k=k+1
}
for(i in 312:411){
lines(fit$Gen,fit[,i],col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="red",ylim=c(-1,20))
for(i in 312:411){
lines(fit$Gen,fit[,i],col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,20))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],col=colfunc(10)[k])
k=k+1
}
lines(fit$Gen,fit[,330])
lines(fit$Gen,fit[,441])
lines(fit$Gen,fit[,411])
lines(fit$Gen,fit[,410])
lines(fit$Gen,fit[,409])
lines(fit$Gen,fit[,400])
lines(fit$Gen,fit[,390])
lines(fit$Gen,fit[,380])
lines(fit$Gen,fit[,370])
lines(fit$Gen,fit[,360])
lines(fit$Gen,fit[,350])
lines(fit$Gen,fit[,340])
lines(fit$Gen,fit[,330])
lines(fit$Gen,fit[,320])
lines(fit$Gen,fit[,312])
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P1_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
lines(fit$Gen,fit[,312],col=colfunc(10)[k])
fit[,312]
colfunc(10)
colfunc(10)[k]
k
k=1
View(fit)
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,312])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i])
k=k+1
}
?near
rep(1:10,10)
?rep
rep.int(1:10,10)
rep.int(1,10)
rep(1,10)
apply(1:10,rep(x,10))
apply(1:10,FUN=rep(x,10))
sapply(1:10,FUN=rep(x,10))
?sapply
sapply(X=1:10,FUN=rep(X,10))
?rep
rep(1:10,each=10)
deme=rep(1:10,each=10)
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
deme=rep(1:10,each=10)
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[deme[k]])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,20))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,1))
deme=rep(1:10,each=10)
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[deme[k]])
k=k+1
}
plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 2",col="white",ylim=c(-1,20))
deme=rep(1:10,each=10)
k=1
for(i in 312:411){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[deme[k]])
k=k+1
}
#For mulilocus model
plot(fit$Gen,fit$P19_env1,type="l", main=plotTitle, xlab="Generations",ylab="Environmental optimum 1",col="white",ylim=c(-1,1))
k=1
for(i in 212:311){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
fit$Gen
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,2))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 109)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 109)
print(k)
#lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
View(fit)
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 212)
print(k)
#lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(-1,10))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 212)
print(k)
#lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(-1,10))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 212)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(-1,10))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 112)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,5))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 112)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
