#          colour=rgb(0,0,0, 0.75), lwd=1) +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
ggtitle(paste(plotTitle,"Gen. 300")) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
M2
1-M2
gfM1 <- gradientForest(data=data.frame(envPop, 1-M2),
predictor.vars=colnames(envPop),
response.vars=colnames(M2),
corr.threshold=0.5,
ntree=500,
trace=T)
gfM1Trans1 <- predict(gfM1, envPop)
colnames(gfM2Trans1)<-"C.Imp_M2_before"
ggplot() +
geom_line(aes(x=envPop$envSelect, y=gfM1Trans1$C.Imp_M2_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
#facet_grid(. ~ strSel) +
labs(y="Cumulative Importance", x="Environment") +
#geom_line(data=cImpMAF.neut, aes(x=x, y=y),
#          colour=rgb(0,0,1, 0.75), lwd=1) +
#geom_line(data=cImpMAF.sel, aes(x=x, y=y),
#          colour=rgb(1,0,0, 0.75), lwd=1) +
#geom_line(data=cImpMAF, aes(x=x, y=y),
#          colour=rgb(0,0,0, 0.75), lwd=1) +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
ggtitle(paste(plotTitle,"Gen. 300")) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
gfM1Trans1$C.Imp_M2_before
gfM1Trans1
colnames(gfM1Trans1)<-"C.Imp_M1_before"
ggplot() +
geom_line(aes(x=envPop$envSelect, y=gfM1Trans1$C.Imp_M1_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
#facet_grid(. ~ strSel) +
labs(y="Cumulative Importance", x="Environment") +
#geom_line(data=cImpMAF.neut, aes(x=x, y=y),
#          colour=rgb(0,0,1, 0.75), lwd=1) +
#geom_line(data=cImpMAF.sel, aes(x=x, y=y),
#          colour=rgb(1,0,0, 0.75), lwd=1) +
#geom_line(data=cImpMAF, aes(x=x, y=y),
#          colour=rgb(0,0,0, 0.75), lwd=1) +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
ggtitle(paste(plotTitle,"Gen. 300")) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
require(ggplot2)
require(reshape2)
require(RColorBrewer)
require(stringr)
colfunc<-colorRampPalette(c("orange","cyan"))
cg<-read.table(paste("results/SLiM_output/CG_files/",seed,"_SL_WF_CG_AtagP_Gen300.txt",sep=""),header=F)
colnames(cg)<-paste("D",seq(1:100),sep="")
cg$Transplant<-rep(paste("T",seq(1:10),sep=""),10)
cg_df <- melt(cg,  id.vars ="Transplant",  variable.name = "Genotype",
value.name = "Fitness")
cg_df$Transplant<-factor(cg_df$Transplant,levels=cg_df$Transplant[1:10])
CI_bf <- gfTrans1$C.Imp_genome_before[1:10]
CI<-NULL
for(i in 1:length(CI_bf)){
for(j in 1:length(CI_bf)){
CI<-c(CI,CI_bf[j]-CI_bf[i])
}
}
CI_rep<-NULL
for (i in seq(1,100,10)){
CI_rep<-c(CI_rep,rep(CI[i:(i+9)],10))
}
CIm_bf <- gfM2Trans1$C.Imp_M2_before[1:10]
CIm<-NULL
for(i in 1:length(CIm_bf)){
for(j in 1:length(CIm_bf)){
CIm<-c(CIm,CIm_bf[j]-CIm_bf[i])
}
}
CIm_rep<-NULL
for (i in seq(1,100,10)){
CIm_rep<-c(CIm_rep,rep(CIm[i:(i+9)],10))
}
Home<-NULL
for(i in 1:10){
Home<-c(Home,rep(paste("H",i,sep=""),100))
}
cg_df$Home <- rep(Home,10)
cg_df$Home<-factor(cg_df$Home,levels=unique(cg_df$Home))
cg_df$D_CI<-CI_rep
cg_df$D_CIm<-CIm_rep
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="lm",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CIm), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CIm)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (allele)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative Fitness in common garden")+
xlab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
cg_df$D_CI
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
#geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
#geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative Fitness in common garden")+
xlab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
#geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
#geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative Fitness in common garden")+
xlab("GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative Fitness in common garden")+
ylab("GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative Fitness in common garden")+
xlab("GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CI), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CI)),method="lm",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative Fitness in common garden")+
xlab("GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(x=cg_df$Fitness, y=abs(cg_df$D_CIm), colour=cg_df$Transplant))+
geom_smooth(aes(x=cg_df$Fitness, y=abs(cg_df$D_CIm)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Relative fitness in common garden")+
ylab("GF Offset (allele)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CIm), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CIm)),method="loess",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative fitness in common garden")+
xlab("GF Offset (allele)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=cg_df,aes(y=cg_df$Fitness, x=abs(cg_df$D_CIm), colour=cg_df$Transplant))+
geom_smooth(aes(y=cg_df$Fitness, x=abs(cg_df$D_CIm)),method="lm",se = F)+
geom_point(aes(shape=cg_df$Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10))+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Relative fitness in common garden")+
xlab("GF Offset (allele)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
dat_filt<-cg_df[cg_df$Transplant%in%c("T1","T5","T10"),]
colfunc(10)[1,5,10]
colfunc(10)[c(1,5,10)]
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(x=Fitness, y=D_CI), method="loess",se = F)+
geom_point(aes(x=Fitness, y=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
coord_flip()+
#coord_cartesian(ylim=c(0.5,1.5))+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
dat_filt$D_CI<-abs(dat_filt$D_CI)
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(x=Fitness, y=D_CI), method="loess",se = F)+
geom_point(aes(x=Fitness, y=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
coord_flip()+
#coord_cartesian(ylim=c(0.5,1.5))+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(y=Fitness, x=D_CI), method="loess",se = F)+
geom_point(aes(y=Fitness, x=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(y=Fitness, x=D_CI), method="lm",se = F)+
geom_point(aes(y=Fitness, x=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(x=Fitness, y=abs(D_CIm), colour=Transplant))+
geom_smooth(method="loess",se = F)+
geom_point(aes(shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[4:7])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (allele)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(y=Fitness, x=abs(D_CIm), colour=Transplant))+
geom_smooth(method="lm",se = F)+
geom_point(aes(shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[4:7])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Average relative fitness in common garden")+
xlab("Absolute GF Offset (allele)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(y=Fitness, x=abs(D_CIm), colour=Transplant))+
geom_smooth(method="lm",se = F)+
geom_point(aes(shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Average relative fitness in common garden")+
xlab("Absolute GF Offset (allele)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
View(dat_filt)
abs(dat_filt$D_CIm)
range(abs(dat_filt$D_CIm))
ggplot() +
geom_line(aes(x=envPop$envSelect, y=gfTrans1$C.Imp_genome_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
#facet_grid(. ~ strSel) +
labs(y="GF Cumulative Importance", x="Environment") +
#geom_line(data=cImpMAF.neut, aes(x=x, y=y),
#          colour=rgb(0,0,1, 0.75), lwd=1) +
#geom_line(data=cImpMAF.sel, aes(x=x, y=y),
#          colour=rgb(1,0,0, 0.75), lwd=1) +
#geom_line(data=cImpMAF, aes(x=x, y=y),
#          colour=rgb(0,0,0, 0.75), lwd=1) +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
ggtitle(plotTitle) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(x=Fitness, y=D_CI), method="loess",se = F)+
geom_point(aes(x=Fitness, y=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(y=Fitness, x=D_CI), method="lm",se = F)+
geom_point(aes(y=Fitness, x=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
xlab("Average relative fitness in common garden")+
ylab("Absolute GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot(data=dat_filt,aes(colour=Transplant))+
geom_smooth(aes(y=Fitness, x=D_CI), method="lm",se = F)+
geom_point(aes(y=Fitness, x=D_CI,shape=Home), size=3)+
labs(shape="Genotype", colour="Common\nGarden\nLocation")+
scale_color_manual(values = colfunc(10)[c(1,5,10)])+
scale_shape_manual(values=c(15,18,16,17,19,20,21,22,23,25))+
ylab("Average relative fitness in common garden")+
xlab("Absolute GF Offset (genome)")+
#coord_flip()+
theme_classic()+
theme(axis.text=element_text(size=12),axis.title=element_text(size=14))
ggplot()+
geom_boxplot(aes(x=fitt[fitt$Type=="Env",]$Location,y=fitt[fitt$Type=="Freq",]$Gen301,col=fitt[fitt$Type=="Freq",]$Location))+
scale_colour_manual(values = colfunc(10))+
xlab("Environment type")+
ylab("Allele frequency of allele under selection")+
theme_classic()+
theme(legend.position = "none")
require(OutFLANK)
require(vcfR)
require(adegenet)
require(gdm)
require(gradientForest)
require(foreach)
require(doParallel)
require(pbapply)
require(gdata)
require(data.table)
require(PresenceAbsence)
require(ROCR)
require(modEvA)
require(dplyr)
require(grid)
require(gridExtra)
require(gtools)
require(stringr)
require(reshape2)
require(hierfstat)
#setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")
#setwd("/Users/akijarl/Desktop/TTT_Offset_Vulnerability_GF_Sims/")
setwd("E:/Research_AJL/TTT_Offset_Vulnerability_GF_Sims/")
list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))]
#seed = 1599298910931
f1<-list.files("results/SLiM_output/Sim_sum")[grep(".txt",list.files("results/SLiM_output/Sim_sum"))][16]
(seed<-substr(f1, start=1, stop=13))
#fit<-read.table(paste("Fit_SP_100_",seed,".txt",sep=""),fill=T)
fit<-read.table(paste("results/SLiM_output/Sim_sum/",seed,"_Freq_ML_WF.txt",sep=""))
fit_nam <- NULL
for(i in 1:100){
fit_nam <- c(fit_nam,paste("P",i,"_fit",sep=""))
}
freq_nam <- NULL
for(i in 1:100){
freq_nam <- c(freq_nam,paste("P",i,"_freq",sep=""))
}
phen1_nam <- NULL
for(i in 1:100){
phen1_nam <- c(phen1_nam,paste("P",i,"_phen",sep=""))
}
phen2_nam <- NULL
for(i in 1:100){
phen2_nam <- c(phen2_nam,paste("P",i,"_phen",sep=""))
}
env1_nam <- NULL
for(i in 1:100){
env1_nam <- c(env1_nam,paste("P",i,"_env1",sep=""))
}
env2_nam <- NULL
for(i in 1:100){
env2_nam <- c(env2_nam,paste("P",i,"_env2",sep=""))
}
colnames(fit)<-c("m","n","u","r","mean_Eff", "var_Eff", "var_Opt", "Env_rate","Burnin","Env_shift", "Generation", fit_nam, freq_nam, phen1_nam, phen2_nam, env1_nam, env2_nam)
N<-data.frame(fit$n[1]*100)
#####################################################
#Code for Exon Cap analysis of Tripneustes sequences
#####################################################
#File "All.calls.FFF.recode.vcf" generated as described in document Methods.txt in folder Tripnuestes
setwd("C:/Users/18084/Desktop/Tripneustes/")
require(OutFLANK)
require(vcfR)
require(ggplot2)
require(ggrepel)
require(SNPRelate)
require(gdsfmt)
install.packages("ggrepel")
require(BiocManager)
BiocManager::install("SNPRelate")
