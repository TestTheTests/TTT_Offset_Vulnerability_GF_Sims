theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
#ggtitle(paste(plotTitle,", alleles under selection")) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
D <- ggplot() +
geom_line(aes(x=envPop2$envPop2, y=gfTrans1_sel2$C.Imp_genome_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
#facet_grid(. ~ strSel) +
ylab("\n(Adaptive)\n") +
xlab("Environment 2")+
#geom_line(data=cImpMAF.neut, aes(x=x, y=y),
#          colour=rgb(0,0,1, 0.75), lwd=1) +
#geom_line(data=cImpMAF.sel, aes(x=x, y=y),
#          colour=rgb(1,0,0, 0.75), lwd=1) +
#geom_line(data=cImpMAF, aes(x=x, y=y),
#          colour=rgb(0,0,0, 0.75), lwd=1) +
#theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#ggtitle("Lost > 5") +
scale_y_continuous(position = "right", sec.axis = sec_axis(~., labels = NULL),limits = c(-0.002,0.05)) +
#ggtitle(plotTitle) +
#scale_x_continuous(limits=c(-4,7))+
theme(plot.title = element_text(size=14, face="bold.italic"))
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,C,D,nrow=3,ncol=2,rel_heights = c(1,3,3))
## Visualize CI for individual alleles
cImp1sel <- cImp1[cImp1$allele%in%select_pos,]
A <- ggplot() +
geom_line(data=cImp1, aes(x=x , y=y, group=allele), color="grey", lwd=1.5) +
geom_line(data=cImp1sel, aes(x=x , y=y, group=allele),color="red",lwd=1.5) +
ylab("Cumulative Importance")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
ylim(0.0,0.5)
cImp2sel <- cImp2[cImp2$allele%in%select_pos,]
B <- ggplot() +
geom_line(data=cImp2, aes(x=x , y=y, group=allele), color="grey", lwd=1.5) +
geom_line(data=cImp2sel, aes(x=x , y=y, group=allele),color="red",lwd=1.5) +
ylab("Cumulative Importance")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
ylim(0.0,0.5)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3))
A <- ggplot() +
geom_line(data=cImp1, aes(x=x , y=y, group=allele), color="grey", lwd=1.5) +
geom_line(data=cImp1sel, aes(x=x , y=y, group=allele),color="red",lwd=1.5) +
ylab("Cumulative Importance")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
ylim(0.0,0.4)
cImp2sel <- cImp2[cImp2$allele%in%select_pos,]
B <- ggplot() +
geom_line(data=cImp2, aes(x=x , y=y, group=allele), color="grey", lwd=1.5) +
geom_line(data=cImp2sel, aes(x=x , y=y, group=allele),color="red",lwd=1.5) +
ylab("Cumulative Importance")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
ylim(0.0,0.4)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3))
#plot the allele frequencies of the ten alleles with the highest CI values
top_al1<-unique(cImp1[order(cImp1$y,decreasing = T),]$allele)[1:10]
length(unique(cImp1$allele))
alf1<-Pop_afreq1[,colnames(Pop_afreq1)%in%top_al1]
alf1$Env1 <- envPop1$envPop1
alf1b <- melt(alf1, id = "Env1", variable.name = "Allele")
alf1c <- alf1b %>%
group_by(Env1,Allele) %>%
summarise(average = mean(value))
A <-
ggplot() +
geom_line(data=alf1c, aes(x=Env1, y=average, linetype=Allele, color=Allele),lwd=1) +
ylab("Allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
ylim(0.0,1)
top_al2<-unique(cImp2[order(cImp2$y,decreasing = T),]$allele)[1:10]
length(unique(cImp2$allele))
alf2<-Pop_afreq1[,colnames(Pop_afreq1)%in%top_al2]
alf2$Env2 <- envPop2$envPop2
alf2b <- melt(alf2, id = "Env2", variable.name = "Allele")
alf2c <- alf2b %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2c, aes(x=Env2, y=average, linetype=Allele, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
# theme(axis.text.y = element_text(size = 16, colour = "grey60"),
#       axis.title.y = element_text(size=24, vjust=1)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
ylim(0.0,1)+
theme(plot.title = element_text(size=14, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1.1,1))
alf1s<-alFreq_sel
alf1s$Env1 <- envPop1$envPop1
alf1sb <- melt(alf1s, id = "Env1", variable.name = "Allele")
alf1sc <- alf1sb %>%
group_by(Env1,Allele) %>%
summarise(average = mean(value))
A <-
ggplot() +
geom_line(data=alf1sc, aes(x=Env1, y=average, color=Allele),lwd=1) +
ylab("Adapted allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
guides(color = FALSE) +
ylim(0.0,1)
alf2s<-alFreq_sel
alf2s$Env2 <- envPop2$envPop2
alf2sb <- melt(alf2s, id = "Env2", variable.name = "Allele")
alf2sc <- alf2sb %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2sc, aes(x=Env2, y=average, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
ylim(0.0,1)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1,1.5))
A <-
ggplot() +
geom_line(data=alf1sc, aes(x=Env1, y=average, color=Allele),lwd=1) +
ylab("Adapted allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
guides(color = FALSE) +
ylim(0.0,1)
alf2s<-alFreq_sel
alf2s$Env2 <- envPop2$envPop2
alf2sb <- melt(alf2s, id = "Env2", variable.name = "Allele")
alf2sc <- alf2sb %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2sc, aes(x=Env2, y=average, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
guides(color = FALSE) +
ylim(0.0,1)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1,1.5))
alf1sc
alf1sb
View(alf1sb)
View(alf1s)
alFreq_sel
Pop_afreq1
View(Pop_afreq1)
alf1sc
Pop_afreq1$M6298
colnamed(Pop_afreq1)=="M6298"
colname(Pop_afreq1)=="M6298"
colnames(Pop_afreq1)=="M6298"
G1f[127,]
nrow(geno1_filt)
ncol(geno1_filt)
geno1_filt
geno1_filt[127]
geno1_filt[127,]
length(vcf1_filt@gt[,-1])
length(geno1_filt)
dim(geno1_filt)
length(geno1_filt[127,])
length(geno1_filt[127,1000])
length(geno1_filt[127,1001])
length(geno1_filt[127,])
geno1_filt[127,]
#vcf1_filt <- read.vcfR(paste("results/SLiM_output/VCF_files/T1_",seed,".recode.vcf",sep=""))
vcf1_filt <- read.vcfR(paste("results/SLiM_output/VCF_files/T1_",seed,"_filtered_subset.recode.vcf",sep=""))
View(vcf1_filt)
seed
vcf1_filt@gt[127,-1]
geno1_filt[127,]
geno1_filt <- vcf1_filt@gt[,-1] # Remove 1st column, which is 'Format'
position1_filt <- as.numeric(getPOS(vcf1_filt)) # Positions in bp
chromosome1_filt <- as.numeric(getCHROM(vcf1_filt)) # Chromosome information
No_A<-unname(dim(vcf1_filt)[1]) #Get the number of filtered alleles
rm(vcf1_filt)
gc()
G1f <- matrix(NA, nrow = nrow(geno1_filt), ncol = ncol(geno1_filt))
G1f[geno1_filt %in% c("0/0", "0|0")] <- 0
G1f[geno1_filt %in% c("0/1", "1/0", "1|0", "0|1")] <- 1
G1f[geno1_filt %in% c("1/1", "1|1")] <- 2
Pop_afreq1<-NULL
for(i in 1:100){
Pop_afreq1<-rbind(Pop_afreq1,rowSums(G1f[,Start[i]:Stop[i]])/(2*ncol(G1f[,Start[i]:Stop[i]])))
#print(paste("Start:", Start[i],", Stop:", Stop[i]))
}
Pop_afreq1<-data.frame(Pop_afreq1)
colnames(Pop_afreq1)<-paste("M",position1_filt,sep="")
alf1<-Pop_afreq1[,colnames(Pop_afreq1)%in%top_al1]
alf1$Env1 <- envPop1$envPop1
alf1b <- melt(alf1, id = "Env1", variable.name = "Allele")
alf1c <- alf1b %>%
group_by(Env1,Allele) %>%
summarise(average = mean(value))
A <-
ggplot() +
geom_line(data=alf1c, aes(x=Env1, y=average, linetype=Allele, color=Allele),lwd=1) +
ylab("Allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
ylim(0.0,1)
top_al2<-unique(cImp2[order(cImp2$y,decreasing = T),]$allele)[1:10]
length(unique(cImp2$allele))
alf2<-Pop_afreq1[,colnames(Pop_afreq1)%in%top_al2]
alf2$Env2 <- envPop2$envPop2
alf2b <- melt(alf2, id = "Env2", variable.name = "Allele")
alf2c <- alf2b %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2c, aes(x=Env2, y=average, linetype=Allele, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
# theme(axis.text.y = element_text(size = 16, colour = "grey60"),
#       axis.title.y = element_text(size=24, vjust=1)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
ylim(0.0,1)+
theme(plot.title = element_text(size=14, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1.1,1))
#Merge the population specific allele frequencies of all neutral (M1) alleles with the population specific frequency of the selected (M2) allele
alFreq<-cbind(data.frame(Pop_afreq1))
alFreq_sel<-alFreq[colnames(alFreq)%in%select_pos]
alf1s<-alFreq_sel
alf1s$Env1 <- envPop1$envPop1
alf1sb <- melt(alf1s, id = "Env1", variable.name = "Allele")
alf1sc <- alf1sb %>%
group_by(Env1,Allele) %>%
summarise(average = mean(value))
A <-
ggplot() +
geom_line(data=alf1sc, aes(x=Env1, y=average, color=Allele),lwd=1) +
ylab("Adapted allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
guides(color = FALSE) +
ylim(0.0,1)
alf2s<-alFreq_sel
alf2s$Env2 <- envPop2$envPop2
alf2sb <- melt(alf2s, id = "Env2", variable.name = "Allele")
alf2sc <- alf2sb %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2sc, aes(x=Env2, y=average, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
guides(color = FALSE) +
ylim(0.0,1)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1,1.5))
ggplot() +
geom_line(data=alf1sc, aes(x=Env1, y=average, color=Allele),lwd=1) +
ylab("Adapted allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
guides(color = FALSE) +
ylim(0.0,1)
alf1sc
alFreq_sel
alFreq_sel[is.na(alFreq_sel),]
alFreq_sel[is.na(alFreq_sel)]
alFreq_sel[is.na(alFreq_sel)]
alFreq_sel[,is.na(alFreq_sel)]
alFreq_sel[which(is.na(alFreq_sel))]
alFreq_sel[which(is.na(alFreq_sel)),]
alFreq_sel[127,]
alFreq_sel
View(alFreq_sel)
"M16833"
vcf1_filt <- read.vcfR(paste("results/SLiM_output/VCF_files/T1_",seed,"_filtered_subset.recode.vcf",sep=""))
geno1_filt <- vcf1_filt@gt[,-1] # Remove 1st column, which is 'Format'
position1_filt <- as.numeric(getPOS(vcf1_filt)) # Positions in bp
chromosome1_filt <- as.numeric(getCHROM(vcf1_filt)) # Chromosome information
No_A<-unname(dim(vcf1_filt)[1]) #Get the number of filtered alleles
rm(vcf1_filt)
gc()
G1f <- matrix(NA, nrow = nrow(geno1_filt), ncol = ncol(geno1_filt))
G1f[geno1_filt %in% c("0/0", "0|0")] <- 0
G1f[geno1_filt %in% c("0/1", "1/0", "1|0", "0|1")] <- 1
G1f[geno1_filt %in% c("1/1", "1|1")] <- 2
#Check number of duplicate positions
sum(duplicated(position1_filt))
position1_filt[duplicated(position1_filt)]
sum(duplicated(position2_filt))
#Read in positions of m2 mutations
pos_T1<-scan(paste("results/SLiM_output/Sim_sum/",seed,"_T1_Pos_ML_WF.txt",sep=""))
sum(duplicated(pos_T1))
select_pos_num <-unique(pos_T1)
duplic_pos <- position1_filt[duplicated(position1_filt)]
select_pos <- paste("M",unique(pos_T1),sep="")
for(i in 1:length(position1_filt)){
if(duplicated(position1_filt)[i]){
position1_filt[i]<-position1_filt[i]+0.5
}
}
Start<-seq(1,ncol(geno1_filt),10)
#Stop<-seq(100,ncol(geno1_filt),10)
Stop<-seq(10,ncol(geno1_filt),10)
Pop_afreq1<-NULL
for(i in 1:100){
Pop_afreq1<-rbind(Pop_afreq1,rowSums(G1f[,Start[i]:Stop[i]])/(2*ncol(G1f[,Start[i]:Stop[i]])))
#print(paste("Start:", Start[i],", Stop:", Stop[i]))
}
Pop_afreq1<-data.frame(Pop_afreq1)
colnames(Pop_afreq1)<-paste("M",position1_filt,sep="")
View(Pop_afreq1)
#Merge the population specific allele frequencies of all neutral (M1) alleles with the population specific frequency of the selected (M2) allele
alFreq<-cbind(data.frame(Pop_afreq1))
View(alFreq)
alFreq_sel<-alFreq[colnames(alFreq)%in%select_pos]
View(alFreq_sel)
alf1s<-alFreq_sel
alf1s$Env1 <- envPop1$envPop1
alf1sb <- melt(alf1s, id = "Env1", variable.name = "Allele")
alf1sc <- alf1sb %>%
group_by(Env1,Allele) %>%
summarise(average = mean(value))
A <-
ggplot() +
geom_line(data=alf1sc, aes(x=Env1, y=average, color=Allele),lwd=1) +
ylab("Adapted allele frequency (average)")+
xlab("Environment 1") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16)) +
#scale_color_discrete_qualitative(palette = "Pastel")+
#geom_text(aes(x=rep(-0.75,10),y= c(seq(0.5,0.3,length.out =10)), label =top_al1))+
#annotate("text",x = -1, y =0.5, label=paste(top_al1))+
guides(color = FALSE) +
ylim(0.0,1)
alf2s<-alFreq_sel
alf2s$Env2 <- envPop2$envPop2
alf2sb <- melt(alf2s, id = "Env2", variable.name = "Allele")
alf2sc <- alf2sb %>%
group_by(Env2,Allele) %>%
summarise(average = mean(value))
B <- ggplot() +
geom_line(data=alf2sc, aes(x=Env2, y=average, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
guides(color = FALSE) +
ylim(0.0,1)
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1,1.5))
alf2sc
alf1sc[is.na(alf1sc$average)]
alf1sc[is.na(alf1sc$average),]
View(N)
View(Pop_afreq1)
Pop_afreq1$M129053
length(Pop_afreq1$M129053)
length(is.na(Pop_afreq1$M129053))
length(Pop_afreq1$M129053)
geno1_filt
B <- ggplot() +
geom_line(data=alf2sc, aes(x=Env2, y=average, color=Allele),lwd=1) +
ylab("")+
xlab("Environment 2") +
theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
theme_bw() +
theme(axis.text.x = element_text(size = 18, colour = "grey60"),
axis.title.x = element_text(size=24)) +
theme(axis.text.y = element_text(size = 16, colour = "grey60"),
axis.title.y = element_text(size=24, vjust=1)) +
theme(strip.text = element_text(size=16))+
guides(color = FALSE) +
ylim(0.0,1)+
theme(plot.title = element_text(size=14, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
title <- ggdraw() + draw_label(plotTitle, fontface='bold')
plot_grid(title,NULL,A,B,nrow=2,ncol=2,rel_heights = c(1,3), rel_widths = c(1.1,1))
