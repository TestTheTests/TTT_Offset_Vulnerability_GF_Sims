group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_8.5_Tropic_sd_LL)<-c("Years", "Latitude", "Longitude","Temp_sd","pH_sd")
#Specify data source
dat_8.5_Tropic_sd_LL$Source<-as.factor("Projection_8.5")
#Get temprate subset of data from Projected 8.5 dataset
dat_8.5_Temprate_sd_LL<-dat_2100_8.5_new[dat_2100_8.5_new$latitude>40 & dat_2100_8.5_new$latitude<45 & dat_2100_8.5_new$longitude>290 & dat_2100_8.5_new$longitude<320]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_8.5_Temprate_sd_LL)<-c("Years", "Latitude", "Longitude", "Temp_sd","pH_sd")
#Specify data source
dat_8.5_Temprate_sd_LL$Source<-as.factor("Projection_8.5")
#C
dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-4]
dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,]
Tdat_LL<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5])
ggplot(data=Tdat_LL[!Tdat_LL$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
#Combine all data into one for visualization
#Tdat<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_4.5_Tropic_sd[,-4],dat_4.5_Temprate_sd[,-4],dat_8.5_Tropic_sd[,-4],dat_8.5_Temprate_sd[,-4],dat_1800_Tropic_sd[,-4],dat_1800_Temprate_sd[,-4])
#Dataset focused on 1970-2020
Tdat<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-4],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-4])
Tdat_LL<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5])
omit<-c(1905:1969,1988,2018)
#Removing 1950 and 2018 from dataset and visualizing again
SST<-ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
SST_LL<-ggplot(data=Tdat_LL[!Tdat_LL$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
#Code below is specific to pH data visualization
#Combine all data into one for visualization
#Tdat<-bind_rows(nh_sd,hots_sd,dat_4.5_Tropic_sd,dat_4.5_Temprate_sd,dat_8.5_Tropic_sd,dat_8.5_Temprate_sd,dat_1800_Tropic_sd,dat_1800_Temprate_sd)
TdatPh<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,])
TdatPh_LL<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,])
omit<-c(1905:1969)
ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
ggplot(data=TdatPh_LL[!TdatPh_LL$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
omit<-c(1905:1969,1988,2018)
#Removing 1950 and 2018 from dataset and visualizing again
SST<-ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
SST_LL<-ggplot(data=Tdat_LL[!Tdat_LL$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
#Code below is specific to pH data visualization
#Combine all data into one for visualization
#Tdat<-bind_rows(nh_sd,hots_sd,dat_4.5_Tropic_sd,dat_4.5_Temprate_sd,dat_8.5_Tropic_sd,dat_8.5_Temprate_sd,dat_1800_Tropic_sd,dat_1800_Temprate_sd)
TdatPh<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,])
TdatPh_LL<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,])
omit<-c(1905:1969)
pH<-ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
pH<-ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
pH_LL<-ggplot(data=TdatPh_LL[!TdatPh_LL$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
legend <- get_legend(SST)
SST<-SST+ theme(legend.position="none")
SST_LL<-SST_LL+ theme(legend.position="none")
grid.arrange(SST,pH,legend,SST_LL, Ph_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,legend,SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,,SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,NA,SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,,SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
grid.arrange(SST,pH,"",SST_LL, pH_LL,legend,ncol=3,nrow=2,widths=c(2, 2, 1))
tmp <- arrangeGrob(SST, pH, SST_LL, pH_LL, layout_matrix = matrix(c(2, 2), nrow = 2))
grid.arrange(tmp,legend,ncol=2,nrow=1,widths=c(4, 1))
tmp
?arrangeGrob
grid.arrange(tmp,legend,ncol=1,nrow=1,widths=c(4, 1))
grid.arrange(tmp,legend)#,ncol=1,nrow=1,widths=c(4, 1))
?matrix
tmp <- arrangeGrob(SST, pH, SST_LL, pH_LL, layout_matrix = matrix(c(1,2,3,4), nrow = 2))
tmp
grid.arrange(tmp,legend,ncol=2,nrow=1,widths=c(4, 1))
tmp <- arrangeGrob(SST, SST_LL, pH, pH_LL, layout_matrix = matrix(c(1,2,3,4), nrow = 2))
grid.arrange(tmp,legend,ncol=2,nrow=1,widths=c(4, 1))
require(OutFLANK)
require(vcfR)
require(adegenet)
require(gdm)
require(gradientForest)
require(foreach)
require(doParallel)
require(pbapply)
require(gdata)
require(data.table)
require(PresenceAbsence)
require(ROCR)
require(modEvA)
require(dplyr)
require(grid)
require(gridExtra)
require(gtools)
require(stringr)
require(reshape2)
#setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")
setwd("/Users/akijarl/Desktop/TTT_Offset_Vulnerability_GF_Sims/")
list.files("SLiM_output")[grep(".txt",list.files("SLiM_output"))]
linst.files()
list.files()
#setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")
setwd("/Users/akijarl/Desktop/TTT_Offset_Vulnerability_GF_Sims/")
setwd("/Users/akijarl/Desktop/PostDoc/TTT_Offset_Vulnerability_GF_Sims/")
list.files("SLiM_output")[grep(".txt",list.files("SLiM_output"))]
#f1<-list.files()[grep(".txt",list.files())][11]
f1<-list.files("SLiM_output")[grep(".txt",list.files("SLiM_output"))][1]
#(seed<-substr(f1, start=12, stop=24))
(seed<-substr(f1, start=0, stop=13))
f1
#(seed<-substr(f1, start=12, stop=24))
(seed<-substr(f1, start=0, stop=13))
#g1<-substr(f1, start=25, stop=31)
#g1<-substr(f1, start=27, stop=33)
g1 <-"Gen600"
#fit<-read.table(paste("Fit_SP_100_",seed,".txt",sep=""),fill=T)
fit<-read.table(paste("SLiM_output/",f1,sep=""))
fit_nam <- NULL
for(i in 1:100){
fit_nam <- c(fit_nam,paste("P",i,"_fit",sep=""))
}
freq_nam <- NULL
for(i in 1:100){
freq_nam <- c(freq_nam,paste("P",i,"_freq",sep=""))
}
env_nam <- NULL
for(i in 1:100){
env_nam <- c(env_nam,paste("P",i,"_env",sep=""))
}
colnames(fit)<-c("m","n","u","r","Env_rate","Burnin","Env_shift", "Generation", fit_nam, freq_nam, env_nam)
View(fit)
N<-data.frame(fit$n[1]*100)
#N<-data.frame(sum(fit$n1[1],fit$n2[1],fit$n3[1],fit$n4[1],fit$n5[1],fit$n6[1],fit$n7[1],fit$n8[1],fit$n9[1],fit$n10[1])*10)
colnames(N)<-"N"
(specs<-data.frame(seed,fit[1,1:2],N,fit[1,3:7]))
plotTitle <- paste(colnames(specs)[1],":",specs[[1]],", ", colnames(specs)[2],":",specs[2],", ",colnames(specs)[3],":",specs[3],", ",colnames(specs)[4],":",specs[4],",",colnames(specs)[5],":",specs[5],", ",colnames(specs)[6],":",specs[6],", ",colnames(specs)[7],":",specs[7],", ",colnames(specs)[8],":",specs[8],sep="")
gen_nam <- paste("Gen",fit$Generation,sep="")
fitt<-data.frame(t(fit[,-1:-8]))
colnames(fitt)<-gen_nam
fitt$Location <- as.factor(rep(paste("A",seq(1,10,1),sep=""),30))
fitt$Type <- as.factor(c(rep("Fit",100),rep("Freq",100),rep("Env",100)))
require(ggplot2)
require(cowplot)
require(qqman)
require(RColorBrewer)
colfunc<-colorRampPalette(c("orange","cyan"))
#plot(c(1:10),rep(1,10),col=colfunc(10),pch=19,cex=5) #Get color gradients for matrix image
#fit[1,210:309]<-fit[2,210:309]
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-5,10))
k=1
for(i in 209:308){
lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
k=k+1
}
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_fit,type="l",main=plotTitle ,xlab="Generations",ylab="Relative Fitness",col="red",ylim=c(min(fit[,c(9:108)]),max(fit[,c(9:108)])))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 9)
print(k)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
lines(fit$Gen,fit$P19_fit, col="red")
#par(fig = c(0,1,0,1))
plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,1))
x=1:10
y=1:10
for(i in x){
for(j in y){
k=((i - 1) + (j - 1) * 10 + 109)
lines(fit$Gen,fit[,k],col=colfunc(10)[i])
}
}
lines(fit$Gen,fit$P19_freq, col="red")
ggplot()+
geom_boxplot(aes(x=fitt[fitt$Type=="Env",]$Location,y=fitt[fitt$Type=="Freq",]$Gen301,col=fitt[fitt$Type=="Freq",]$Location))+
scale_colour_manual(values = colfunc(10))+
xlab("Environment type")+
ylab("Allele frequency of allele under selection")+
theme_classic()+
theme(legend.position = "none")
fitt$Location
as.factor(rep(paste("A",seq(1,10,1),sep=""),30))
paste("A",seq(1,10,1),sep="")
fitt$Location <- factor(rep(paste("A",seq(1,10,1),sep=""),30),levels = paste("A",seq(1,10,1),sep=""))
ggplot()+
geom_boxplot(aes(x=fitt[fitt$Type=="Env",]$Location,y=fitt[fitt$Type=="Freq",]$Gen301,col=fitt[fitt$Type=="Freq",]$Location))+
scale_colour_manual(values = colfunc(10))+
xlab("Environment type")+
ylab("Allele frequency of allele under selection")+
theme_classic()+
theme(legend.position = "none")
f1
#Code below specific to SST analysis with longitude included
#Get tropical subset of data from Reconstructed dataset
dat_1800_Tropic_sd_LL<-dat_1800_new[dat_1800_new$latitude>20 & dat_1800_new$latitude<25 ] %>%#& dat_1800_new$longitude>160 & dat_1800_new$longitude<230]  %>%
group_by(year,latitude, longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_1800_Tropic_sd_LL)<-c("Years", "Latitude", "Longitude", "Temp_sd","pH_sd")
#Specify data source
dat_1800_Tropic_sd_LL$Source<-as.factor("Model")
#Get temprate subset of data from Reconstructed dataset
dat_1800_Temprate_sd_LL<-dat_1800_new[dat_1800_new$latitude>40 & dat_1800_new$latitude<45 ] %>% #& dat_1800_new$longitude>290 & dat_1800_new$longitude<320]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_1800_Temprate_sd_LL)<-c("Years", "Latitude", "Longitude", "Temp_sd","pH_sd")
#Specify data source
dat_1800_Temprate_sd_LL$Source<-as.factor("Model")
#Get tropical subset of data from Projected 4.5 dataset
dat_4.5_Tropic_sd_LL<-dat_2100_4.5_new[dat_2100_4.5_new$latitude>20 & dat_2100_4.5_new$latitude<25 ] %>% #& dat_2100_4.5_new$longitude>160 & dat_2100_4.5_new$longitude<230]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_4.5_Tropic_sd_LL)<-c("Years", "Latitude", "Longitude", "Temp_sd","pH_sd")
#Specify data source
dat_4.5_Tropic_sd_LL$Source<-as.factor("Projection_4.5")
#Get temprate subset of data from Projected 4.5 dataset
dat_4.5_Temprate_sd_LL<-dat_2100_4.5_new[dat_2100_4.5_new$latitude>40 & dat_2100_4.5_new$latitude<45 ] %>% #& dat_2100_4.5_new$longitude>290 & dat_2100_4.5_new$longitude<320]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_4.5_Temprate_sd_LL)<-c("Years", "Latitude" , "Longitude","Temp_sd","pH_sd")
#Specify data source
dat_4.5_Temprate_sd_LL$Source<-as.factor("Projection_4.5")
#Get tropical subset of data from Projected 8.5 dataset
dat_8.5_Tropic_sd_LL<-dat_2100_8.5_new[dat_2100_8.5_new$latitude>20 & dat_2100_8.5_new$latitude<25 ] %>% #& dat_2100_8.5_new$longitude>160 & dat_2100_8.5_new$longitude<230]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_8.5_Tropic_sd_LL)<-c("Years", "Latitude", "Longitude","Temp_sd","pH_sd")
#Specify data source
dat_8.5_Tropic_sd_LL$Source<-as.factor("Projection_8.5")
#Get temprate subset of data from Projected 8.5 dataset
dat_8.5_Temprate_sd_LL<-dat_2100_8.5_new[dat_2100_8.5_new$latitude>40 & dat_2100_8.5_new$latitude<45 ] %>% #& dat_2100_8.5_new$longitude>290 & dat_2100_8.5_new$longitude<320]  %>%
group_by(year,latitude,longitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_8.5_Temprate_sd_LL)<-c("Years", "Latitude", "Longitude", "Temp_sd","pH_sd")
#Specify data source
dat_8.5_Temprate_sd_LL$Source<-as.factor("Projection_8.5")
Tdat_LL<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5])
View(Tdat_LL)
dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,5]
dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5]
omit<-c(1905:1969,1988,2018)
ggplot(data=Tdat_LL[!Tdat_LL$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
TdatPh_LL<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,],dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,])
omit<-c(1905:1969)
ggplot(data=TdatPh_LL[!TdatPh_LL$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd_LL[dat_1800_Tropic_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd_LL[dat_1800_Temprate_sd_LL$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
legend <- get_legend(SST)
SST<-SST+ theme(legend.position="none")
SST_LL<-SST_LL+ theme(legend.position="none")
#Alternate narrower window for tropics which is the same range as the temperate
dat_1800_Tropic_sd<-dat_1800_new[dat_1800_new$latitude>20 & dat_1800_new$latitude<25 & dat_1800_new$longitude>180 & dat_1800_new$longitude<210]  %>%
group_by(year,latitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_1800_Tropic_sd)<-c("Years", "Latitude", "Temp_sd","pH_sd")
#Specify data source
dat_1800_Tropic_sd$Source<-as.factor("Model")
#Get tropical subset of data from Projected 4.5 dataset
dat_4.5_Tropic_sd<-dat_2100_4.5_new[dat_2100_4.5_new$latitude>20 & dat_2100_4.5_new$latitude<25 & dat_2100_4.5_new$longitude>180 & dat_2100_4.5_new$longitude<210]  %>%
group_by(year,latitude) %>%
summarise(sd(SST),sd(pH))
colnames(dat_4.5_Tropic_sd)<-c("Years", "Latitude", "Temp_sd","pH_sd")
#Specify data source
dat_4.5_Tropic_sd$Source<-as.factor("Projection_4.5")
omit<-c(1905:1969,1988,2018)
ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
#Combine all data into one for visualization
#Tdat<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_4.5_Tropic_sd[,-4],dat_4.5_Temprate_sd[,-4],dat_8.5_Tropic_sd[,-4],dat_8.5_Temprate_sd[,-4],dat_1800_Tropic_sd[,-4],dat_1800_Temprate_sd[,-4])
#Dataset focused on 1970-2020
Tdat<-bind_rows(cml_sd[,-3],hots_sd[,c(1:2,4:5)],bbh_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-4],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-4])
ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
omit<-c(1905:1969)
ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
#Code below is specific to pH data visualization
#Combine all data into one for visualization
#Tdat<-bind_rows(nh_sd,hots_sd,dat_4.5_Tropic_sd,dat_4.5_Temprate_sd,dat_8.5_Tropic_sd,dat_8.5_Temprate_sd,dat_1800_Tropic_sd,dat_1800_Temprate_sd)
TdatPh<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,])
#Code below is specific to pH data visualization
#Combine all data into one for visualization
#Tdat<-bind_rows(nh_sd,hots_sd,dat_4.5_Tropic_sd,dat_4.5_Temprate_sd,dat_8.5_Tropic_sd,dat_8.5_Temprate_sd,dat_1800_Tropic_sd,dat_1800_Temprate_sd)
TdatPh<-bind_rows(nh_sd,hots_sd,dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,],dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,])
ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
#Removing 1950 and 2018 from dataset and visualizing again
SST<-ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
omit<-c(1905:1969,1988,2018)
#Removing 1950 and 2018 from dataset and visualizing again
SST<-ggplot(data=Tdat[!Tdat$Years%in%omit,],aes(x=Years,y=Temp_sd,color=Latitude, shape=Source))+
geom_point(size=3)+
xlab("Years")+
ylab("Surface Sea Temperature (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$Temp_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(bbh_sd$Temp_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,-5]$Temp_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(19,15,17,3))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
theme_classic()
omit<-c(1905:1969)
pH<-ggplot(data=TdatPh[!TdatPh$Years%in%omit,],aes(x=Years,y=pH_sd,color=Latitude, shape=Source))+
geom_point(size=3,show.legend=FALSE)+
xlab("Years")+
ylab("pH (standard deviation)")+
geom_hline(yintercept=mean(hots_sd$pH_sd, na.rm = T),col="red")+
geom_hline(yintercept=mean(nh_sd$pH_sd, na.rm = T),col="cyan")+
geom_hline(yintercept=mean(dat_1800_Tropic_sd[dat_1800_Tropic_sd$Years>1830,]$pH_sd, na.rm = T),col="red",linetype="dashed")+
geom_hline(yintercept=mean(dat_1800_Temprate_sd[dat_1800_Temprate_sd$Years>1830,]$pH_sd, na.rm = T),col="cyan",linetype="dashed")+
scale_shape_manual(values=c(17,3,15))+
scale_colour_continuous(name="Latitude",type = "gradient",low="red",high="cyan")+
#guides(
#  color = guide_colorbar(order = 1),
#  fill = guide_legend(order = 0)
#)+
theme_classic()
legend <- get_legend(SST)
SST<-SST+ theme(legend.position="none")
library(gridExtra)
grid.arrange(SST,pH, legend,ncol=3,nrow=1,widths=c(2,2, 1))
