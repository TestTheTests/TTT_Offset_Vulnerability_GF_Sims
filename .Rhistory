ylim(0.1,-1)+
ggtitle("Case 2 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E3<-ggplot(z_edge[z_edge$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Edge")+
ylim(0.1,-1)
C3<-ggplot(z_core[z_core$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Core")+
ylim(0.1,-1)+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E4<-ggplot(z_edge[z_edge$case=="case 4",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 4 Edge")+
ylim(0.1,-1)
C4<-ggplot(z_core[z_core$case=="case 4",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)+
ggtitle("Case 4 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E1l<-ggplot(z_edge[z_edge$case=="case 1",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)', 'FST genome', 'FST causal'))+
#scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)','Causal Env. plus 2 dist. (ED)', 'Causal Env. plus 2 dist. (MD)', 'FST genome', 'FST causal'))+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)
#leg<-get_legend(E1l+theme(legend.margin=margin(t=5, r=0, b=0, l=0, unit="cm")))
leg<-get_legend(E1l)
plot_grid(E1,C1,NULL,E2,C2,leg,E3,C3,NULL, E4,C4,NULL,ncol=3, rel_widths = c(1,0.9,0.6))
#leg<-get_legend(E1l+theme(legend.margin=margin(t=5, r=0, b=0, l=0, unit="cm")))
leg<-get_legend(E1l)
leg<-get_legend(E1l+theme(legend.margin=margin(t=5, r=0, b=0, l=0, unit="cm")))
E1l<-ggplot(z_edge[z_edge$case=="case 1",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)', 'FST genome', 'FST causal'))+
#scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)','Causal Env. plus 2 dist. (ED)', 'Causal Env. plus 2 dist. (MD)', 'FST genome', 'FST causal'))+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)
#leg<-get_legend(E1l+theme(legend.margin=margin(t=5, r=0, b=0, l=0, unit="cm")))
leg<-get_legend(E1l)
E1l
C4
z
x
x
melt(x)
y
require(tidyverse)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
y
z_edge
z$variable
z
y
str(y)
?melt
y<-melt(x,variable.factor = F)
y
str(y)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
y
y$variable
as.character(y$variable)
y$variable<-as.character(y$variable)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
y<-melt(x)
z$variable
y
melt(x)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
z <- y %>%
dplyr::group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
z <- y %>%
dplyr::group_by(case, variable)%>%
dplyr::summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
z_edge <- z[grep("Edge",z$variable),]
z_core <- z[grep("Core",z$variable),]
z_edge <- z_edge[z_edge$variable!="Env_ED_causP2_env_Edges",]
z_edge <- z_edge[z_edge$variable!="Env_MD_causP2_env_Edges",]
z_core <- z_core[z_core$variable!="Env_ED_causP2_env_Cores",]
z_core <- z_core[z_core$variable!="Env_MD_causP2_env_Cores",]
E1<-ggplot(z_edge[z_edge$case=="case 1",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(axis.text.y = element_text(size = 20))+
theme(legend.position = "none")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
scale_y_continuous(trans = "reverse")+
ggtitle("Case 1 Edge")+
ylim(0.1,-1)
C1<-ggplot(z_core[z_core$case=="case 1",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
scale_y_continuous(trans = "reverse")+
ylim(0.1,-1)+
ggtitle("Case 1 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E2<-ggplot(z_edge[z_edge$case=="case 2",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 2 Edge")+
ylim(0.1,-1)
C2<-ggplot(z_core[z_core$case=="case 2",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)+
ggtitle("Case 2 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E3<-ggplot(z_edge[z_edge$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Edge")+
ylim(0.1,-1)
C3<-ggplot(z_core[z_core$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Core")+
ylim(0.1,-1)+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E4<-ggplot(z_edge[z_edge$case=="case 4",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 4 Edge")+
ylim(0.1,-1)
C4<-ggplot(z_core[z_core$case=="case 4",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)+
ggtitle("Case 4 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
E1l<-ggplot(z_edge[z_edge$case=="case 1",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)', 'FST genome', 'FST causal'))+
#scale_fill_discrete("", labels=c('GF off. genome, all env.', 'GF off. genome, causal env.', 'GF off. causal, all env.', 'GF off. causal, causal env.', 'Causal Env. dist. (ED)','Causal Env. dist. (MD)','All Env. dist. (ED)', 'All Env. dist. (MD)','Causal Env. plus 2 dist. (ED)', 'Causal Env. plus 2 dist. (MD)', 'FST genome', 'FST causal'))+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_edge$variable)[1:4],
"ABC",
levels(z_edge$variable)[5:8],
"DEF",
levels(z_edge$variable)[11:12]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)
#leg<-get_legend(E1l+theme(legend.margin=margin(t=5, r=0, b=0, l=0, unit="cm")))
leg<-get_legend(E1l)
plot_grid(E1,C1,NULL,E2,C2,leg,E3,C3,NULL, E4,C4,NULL,ncol=3, rel_widths = c(1,0.9,0.6))
x
y
?pivot_longer()
x$case
z
ggplot(z_core[z_core$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Core")+
ylim(0.1,-1)+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(z_core[z_core$case=="case 3",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2
#position=position_dodge(.9)
)+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ggtitle("Case 3 Core")+
ylim(0.1,-1)+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
z_core[z_core$case=="case 3",]
?summarise
detach("package:dplyr", unload = TRUE)
detach("package:plyr", unload = TRUE)
summarise
#?pivot_longer()
require(tidyverse)
z <- y %>%
dplyr::group_by(case, variable)%>%
dplyr::summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
#?pivot_longer()
require(tidyverse)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
library(plyr)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
detach("package:plyr", unload = TRUE)
library(dplyr)
#?pivot_longer()
require(tidyverse)
z <- y %>%
group_by(case, variable)%>%
summarise (mean = mean(value), IQR = IQR(value), TwoFive = quantile(value,0.25), SevenFive = quantile(value,0.75))
z
ggplot(z_core[z_core$case=="case 2",], aes(variable, mean, fill=variable)) +
geom_bar(position="dodge",stat="identity")+
geom_errorbar(aes(ymin=TwoFive, ymax=SevenFive), width=.2,
position=position_dodge(.9))+
theme_classic()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme(legend.position = "none")+
theme(axis.text.y = element_text(size = 20))+
scale_y_continuous(trans = "reverse")+
scale_x_discrete(limits = c(levels(z_core$variable)[13:16],
"ABC",
levels(z_core$variable)[17:20],
"DEF",
levels(z_core$variable)[23:24]),
labels = c("ABC" = "",
"DEF" = "")) +
ylim(0.1,-1)+
ggtitle("Case 2 Core")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
z_core[z_core$case=="case 2",]
