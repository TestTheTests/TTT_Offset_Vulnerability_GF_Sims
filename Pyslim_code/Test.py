import pyslim, msprime
import numpy as np
import random
import time

start = time.time()
T2 = pyslim.load("TTT_SP_100_TSR_2247691805582_Gen1400.tree")
end = time.time()
print(end - start)

mig_mat = [[0,0,0,0,0],
           [0,0,0.2,0.2,0],
           [0,0.2,0,0,0.2],
           [0,0.2,0,0,0.2],
           [0,0,0.2,0.2,0]]

start = time.time()
recapT2 = T2.recapitate(recombination_rate = 1e-08, migration_matrix=mig_mat, Ne=400,random_seed=1)
end = time.time()
print(end - start)

start = time.time()
T2 = pyslim.load("TTT_SP_100_TSR_2247696049144_Gen1400.tree")
end = time.time()
print(end - start)

mig_mat = [[0,0,0,0,0,0,0,0,0,0],
           [0,0,0.2,0,0.2,0,0,0,0,0],
           [0,0.2,0,0.2,0,0.2,0,0,0,0],
           [0,0,0.2,0,0,0,0.2,0,0,0],
           [0,0.2,0,0,0,0.2,0,0.2,0,0],
           [0,0,0.2,0,0.2,0,0.2,0,0.2,0],
           [0,0,0,0.2,0,0.2,0,0,0,0.2],
           [0,0,0,0,0.2,0,0,0,0.2,0],
           [0,0,0,0,0,0.2,0,0.2,0,0.2],
           [0,0,0,0,0,0,0.2,0,0.2,0]]


start = time.time()
recapT2 = T2.recapitate(recombination_rate = 1e-08, migration_matrix=mig_mat, Ne=900,random_seed=1)
end = time.time()
print(end - start)

start = time.time()
T2 = pyslim.load("TTT_SP_100_TSR_2247697889648_Gen1400.tree")
end = time.time()
print(end - start)

mig_mat = [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
           [0,0,0.2,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0],
           [0,0.2,0,0.2,0,0,0.2,0,0,0,0,0,0,0,0,0,0],
           [0,0,0.2,0,0.2,0,0,0.2,0,0,0,0,0,0,0,0,0],
           [0,0,0,0.2,0,0,0,0,0.2,0,0,0,0,0,0,0,0],
           [0,0.2,0,0,0,0,0.2,0,0,0.2,0,0,0,0,0,0,0],
           [0,0,0.2,0,0,0.2,0,0.2,0,0,0.2,0,0,0,0,0,0],
           [0,0,0,0.2,0,0,0.2,0,0.2,0,0,0.2,0,0,0,0,0],
           [0,0,0,0,0.2,0,0,0.2,0,0,0,0,0.2,0,0,0,0],
           [0,0,0,0,0,0.2,0,0,0,0,0.2,0,0,0.2,0,0,0],
           [0,0,0,0,0,0,0.2,0,0,0.2,0,0.2,0,0,0.2,0,0],
           [0,0,0,0,0,0,0,0.2,0,0,0.2,0,0.2,0,0,0.2,0],
           [0,0,0,0,0,0,0,0,0.2,0,0,0.2,0,0,0,0,0.2],
           [0,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0.2,0,0],
           [0,0,0,0,0,0,0,0,0,0,0.2,0,0,0.2,0,0.2,0],
           [0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0.2,0,0.2],
           [0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0.2,0]]


start = time.time()
recapT2 = T2.recapitate(recombination_rate = 1e-08, migration_matrix=mig_mat, Ne=1600,random_seed=1)
end = time.time()
print(end - start)

start = time.time()
T2 = pyslim.load("TTT_SP_100_TSR_2247696987467_Gen1400.tree")
end = time.time()
print(end - start)

mig_mat=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0.2,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0],
         [0,0,0,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0],
         [0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0,0],
         [0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0,0],
         [0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0,0,0,0],
         [0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0.2,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0,0.2],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2],
         [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0]]

start = time.time()
recapT2 = T2.recapitate(recombination_rate = 1e-08, migration_matrix=mig_mat, Ne=2500,random_seed=1)
end = time.time()
print(end - start)



start = time.time()
T2 = pyslim.load("TTT_SP_100_TSR_2247700676494_Gen1400.tree")
end = time.time()
print(end - start)
