setwd("/Users/akijarl/Desktop/PostDoc/SLiMstuff/TSR_output/")
library(vcfR)

vcf_test1 <- read.vcfR("G5000.vcf", verbose = T)
vcf_test2 <- read.vcfR("G5300.vcf", verbose = T)

geno_test1 <- vcf_test1@gt[,-1] 
geno_test2 <- vcf_test2@gt[,-1] 

position_test1 <- getPOS(vcf_test1) # Positions in bp
position_test2 <- getPOS(vcf_test2) # Positions in bp

G_test1 <- matrix(NA, nrow = nrow(geno_test1), ncol = ncol(geno_test1))
G_test1[geno_test1 %in% c("0/0", "0|0")] <- 0
G_test1[geno_test1  %in% c("0/1", "1/0", "1|0", "0|1")] <- 1
G_test1[geno_test1 %in% c("1/1", "1|1")] <- 2

G_test2 <- matrix(NA, nrow = nrow(geno_test2), ncol = ncol(geno_test2))
G_test2[geno_test2 %in% c("0/0", "0|0")] <- 0
G_test2[geno_test2  %in% c("0/1", "1/0", "1|0", "0|1")] <- 1
G_test2[geno_test2 %in% c("1/1", "1|1")] <- 2

a_freq_test1 <- rowSums(G_test1)/(2*ncol(G_test1))
a_freq_test2 <- rowSums(G_test2)/(2*ncol(G_test2))

par(mfrow=c(1,2))
hist(a_freq_test1, breaks=75,xlab="Allele frequency", main="Gen5000", col="cyan",ylim=c(0,60000))
hist(a_freq_test2, breaks=75, xlab="Allele frequency", main="Gen5300", col="orange",ylim=c(0,60000))

par(mfrow=c(1,2))
hist(position_test1, breaks=10000,xlab="Position", main="T1", col="cyan",ylim=c(0,40))
hist(position_test2, breaks=10000, xlab="Position", main="T2", col="orange",ylim=c(0,40))

plot(position_test1[order(position_test1)],position_test2[order(position_test2)])

G5000<-data.frame(a_freq_test1,position_test1,stringsAsFactors = F)
G5300<-data.frame(a_freq_test2,position_test2,stringsAsFactors = F)

G5K_shared<-G5000[which(G5000$position_test1%in%G5300$position_test2),]
G5.3K_shared<-G5300[which(G5300$position_test2%in%G5000$position_test1),]
G5.3K_shared_min<-G5300[which(G5300$position_test2%in%(G5000$position_test1-1)),]
G5.3K_shared_min2<-G5300[which(G5300$position_test2%in%(G5000$position_test1-2)),]
G5.3K_shared_max<-G5300[which(G5300$position_test2%in%(G5000$position_test1+1)),]
G5.3K_shared_max2<-G5300[which(G5300$position_test2%in%(G5000$position_test1+2)),]

G5.3K_total<-rbind(G5.3K_shared,G5.3K_shared_min,G5.3K_shared_max)
G5.3K_totalShared<-G5.3K_total[!duplicated(G5.3K_total$position_test2),]

G5.3K_total_spread<-rbind(G5.3K_shared,G5.3K_shared_min,G5.3K_shared_max,G5.3K_shared_min2,G5.3K_shared_max2)
G5.3K_totalShared_spread<-G5.3K_total_spread[!duplicated(G5.3K_total_spread$position_test2),]
