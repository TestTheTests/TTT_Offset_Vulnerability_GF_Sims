#Visualizing multilocus data
require(ggplot2)
require(cowplot)
require(qqman)
require(RColorBrewer)

colfunc<-colorRampPalette(c("orange","cyan"))

plot(fit$Gen,fit$P19_phen,type="l", main=plotTitle, xlab="Generations",ylab="Phenotype",col="white",ylim=c(-5,10))
k=1
for(i in 212:311){
  lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
  k=k+1
}

plot(fit$Gen,fit$P19_env2,type="l", main=plotTitle, xlab="Generations",ylab="Environment 1",col="white",ylim=c(-.5,2.5))
k=1
for(i in 212:311){
  lines(fit$Gen,fit[,i],lwd=2,col=colfunc(10)[k])
  k=k+1
}


plot(fit$Gen,fit$P19_fit,type="l",main=plotTitle ,xlab="Generations",ylab="Absolute Fitness",col="red")
x=1:10
y=1:10
for(i in x){
  for(j in y){
    k=((i - 1) + (j - 1) * 10 + 12)
    #print(paste("k = ", k))
    lines(fit$Gen,fit[,k],col=colfunc(10)[i])
  }
}
lines(fit$Gen,fit$P19_fit, col="red")
text(249900,0.78,"Location")
par(fig = c(0.05,0.5, 0.07, 0.55), new = T)
image(matrix(nrow=10,ncol=10,rep(1:10,10),byrow = F),col=colfunc(10),axes=F)+
 abline(v=0.89,col="red")
