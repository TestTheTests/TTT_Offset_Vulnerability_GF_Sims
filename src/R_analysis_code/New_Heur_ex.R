####################################################################
# New heuristic figures
####################################################################

envPop <- data.frame(seq(-1,1,length.out=9))
names(envPop) <- "envSelect"

alFreq_L1<-data.frame(seq(0.1,0.9,length.out=9))
alFreq_L1 <- data.frame(alFreq_L1$seq.0.1..0.9..length.out...9.)
colnames(alFreq_L1)<-"L1"

gfMod1 <- gradientForest(data=data.frame(envPop, alFreq_L1),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L1),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

gf_L1 <- predict(gfMod1, envPop)
colnames(gf_L1)<-"C.Imp"

alFreq_L2<-data.frame(seq(0.3,0.7,length.out=9))
alFreq_L2 <- data.frame(alFreq_L2$seq.0.3..0.7..length.out...9.)
colnames(alFreq_L2)<-"L2"

gfMod2 <- gradientForest(data=data.frame(envPop, alFreq_L2),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L2),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

gf_L2 <- predict(gfMod2, envPop)
colnames(gf_L2)<-"C.Imp"

alFreq_L3<-data.frame(seq(0.45,0.55,length.out=9))
alFreq_L3 <- data.frame(alFreq_L3$seq.0.45..0.55..length.out...9.)
colnames(alFreq_L3)<-"L3"

gfMod3 <- gradientForest(data=data.frame(envPop, alFreq_L3),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L3),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

(gf_L3 <- predict(gfMod3, envPop))
colnames(gf_L3)<-"C.Imp"

alFreq_L4<-data.frame(seq(0.9,0.1,length.out=9))
alFreq_L4 <- data.frame(alFreq_L4$seq.0.9..0.1..length.out...9.)
colnames(alFreq_L4)<-"L4"

gfMod4 <- gradientForest(data=data.frame(envPop, alFreq_L4),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L4),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

(gf_L4 <- predict(gfMod4, envPop))
colnames(gf_L4)<-"C.Imp"

plot(envPop$envSelect,alFreq_L1$L1,type="l",col="blue", xlab="", ylab="",lwd=4, yaxp  = c(0.1, 0.9, 8), las=1, cex.axis=2)
lines(envPop$envSelect,alFreq_L2$L2,col="green",lwd=4)
lines(envPop$envSelect,alFreq_L3$L3,col="red",lwd=4)
lines(envPop$envSelect,alFreq_L4$L4,col="orange",lwd=4)

#cols <- c("AF increasing w/ env"="#0000FFBF","AF decreasing w/ env"="#FF0000BF")
ggplot() + 
  geom_line(aes(x=envPop$envSelect, y=gf_L1$C.Imp), colour="blue", lwd=2) + #blue
  geom_line(aes(x=envPop$envSelect, y=gf_L2$C.Imp),colour="green", lwd=2) + #red
  geom_line(aes(x=envPop$envSelect, y=gf_L3$C.Imp),colour="red", lwd=2) + #red
  geom_line(aes(x=envPop$envSelect, y=gf_L4$C.Imp),colour="orange", lwd=2) + #red
  labs(y="GF Cumulative Importance", x="Environment") +
  theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
  theme_bw() +
  #scale_colour_manual(name="",values=cols) + 
  ggtitle("Linear relationship between allele frequency (AF) and environment")+
  theme(axis.text.x = element_text(size = 18, colour = "grey60"),
        axis.title.x = element_text(size=24)) +
  theme(axis.text.y = element_text(size = 16, colour = "grey60"),
        axis.title.y = element_text(size=24, vjust=1)) +
  theme(strip.text = element_text(size=16)) +
  theme(plot.title = element_text(size=14, face="bold.italic"))+
  theme(legend.position = "none")






envPop <- data.frame(seq(-1,1,length.out=10))
names(envPop) <- "envSelect"

alFreq_L1<-data.frame(c(seq(0.9,0.1,-0.2),seq(0.1,0.9,0.2)))
alFreq_L1 <- data.frame(alFreq_L1$c.seq.0.9..0.1...0.2...seq.0.1..0.9..0.2..)
colnames(alFreq_L1)<-"L1"

gfMod1 <- gradientForest(data=data.frame(envPop, alFreq_L1),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L1),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

gf_L1 <- predict(gfMod1, envPop)
colnames(gf_L1)<-"C.Imp"

alFreq_L2<-data.frame(c(seq(0.7,0.2,length.out=5),seq(0.2,0.7,length.out=5)))
alFreq_L2 <- data.frame(alFreq_L2$c.seq.0.7..0.2..length.out...5...seq.0.2..0.7..length.out...5..)
colnames(alFreq_L2)<-"L2"

gfMod2 <- gradientForest(data=data.frame(envPop, alFreq_L2),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L2),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

(gf_L2 <- predict(gfMod2, envPop))
colnames(gf_L2)<-"C.Imp"

alFreq_L3<-data.frame(c(seq(0.5,0.3,length.out=5),seq(0.3,0.5,length.out=5)))
alFreq_L3 <- data.frame(alFreq_L3$c.seq.0.5..0.3..length.out...5...seq.0.3..0.5..length.out...5..)
colnames(alFreq_L3)<-"L3"

gfMod3 <- gradientForest(data=data.frame(envPop, alFreq_L3),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L3),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

(gf_L3 <- predict(gfMod3, envPop))
colnames(gf_L3)<-"C.Imp"

alFreq_L4<-data.frame(c(seq(0.1,0.9,0.2),seq(0.9,0.1,-0.2))) 
alFreq_L4 <- data.frame(alFreq_L4$c.seq.0.1..0.9..0.2...seq.0.9..0.1...0.2..)
colnames(alFreq_L4)<-"L4"

gfMod4 <- gradientForest(data=data.frame(envPop, alFreq_L4),
                         predictor.vars=colnames(envPop),
                         response.vars=colnames(alFreq_L4),
                         corr.threshold=0.5, 
                         ntree=500, 
                         trace=T)

(gf_L4 <- predict(gfMod4, envPop))
colnames(gf_L4)<-"C.Imp"

plot(envPop$envSelect,alFreq_L1$L1,type="l",col="blue", xlab="", ylab="",lwd=4, yaxp  = c(0.1, 0.9, 8), las=1, cex.axis=2)
lines(envPop$envSelect,alFreq_L2$L2,col="green",lwd=4)
lines(envPop$envSelect,alFreq_L3$L3,col="red",lwd=4)
lines(envPop$envSelect,alFreq_L4$L4,col="orange",lwd=4)

#cols <- c("AF increasing w/ env"="#0000FFBF","AF decreasing w/ env"="#FF0000BF")
ggplot() + 
  geom_line(aes(x=envPop$envSelect, y=gf_L1$C.Imp), colour="blue", lwd=2) + #blue
  geom_line(aes(x=envPop$envSelect, y=gf_L2$C.Imp),colour="green", lwd=2) + #red
  geom_line(aes(x=envPop$envSelect, y=gf_L3$C.Imp),colour="red", lwd=2) + #red
  geom_line(aes(x=envPop$envSelect, y=gf_L4$C.Imp),colour="orange", lwd=2) + #red
  labs(y="GF Cumulative Importance", x="Environment") +
  theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
  theme_bw() +
  #scale_colour_manual(name="",values=cols) + 
  ggtitle("Non-inear relationship between allele frequency (AF) and environment")+
  theme(axis.text.x = element_text(size = 18, colour = "grey60"),
        axis.title.x = element_text(size=24)) +
  theme(axis.text.y = element_text(size = 16, colour = "grey60"),
        axis.title.y = element_text(size=24, vjust=1)) +
  theme(strip.text = element_text(size=16)) +
  theme(plot.title = element_text(size=14, face="bold.italic"))+
  theme(legend.position = "none")