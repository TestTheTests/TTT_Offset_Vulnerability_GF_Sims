require(ggplot2)
require(cowplot)
require(qqman)
require(RColorBrewer)

colfunc<-colorRampPalette(c("orange","cyan"))
#All_equalC1<-gfTrans1$C.Imp_genome_before
#write.table(Scenario2_flip,"results/R_results/Scenario2_flip_CI",row.names = F,col.names = F)

Summary_Pop <- read.csv(file = "results/R_results/1278335993644_summary_Pop.csv")
Env_before <- Summary_Pop$Env_before

All_equalC1<-read.table("results/R_results/1278335993644_CI")
All_equalC2<-read.table("results/R_results/3393663285300_CI")
All_equalC3<-read.table("results/R_results/2207643041387_CI")
All_equalC4<-read.table("results/R_results/6359250998124_CI")
All_equalC5<-read.table("results/R_results/1940819310024_CI")
All_equalC6<-read.table("results/R_results/6040998529642_CI")
All_equalC7<-read.table("results/R_results/6417941976338_CI")
All_equalC8<-read.table("results/R_results/3323115928098_CI")
All_equalC9<-read.table("results/R_results/6232745500281_CI")
All_equalC10<-read.table("results/R_results/5643197868019_CI")
All_equalC11<-read.table("results/R_results/1540759557858_CI")

Neutral_1<-read.table("results/R_results/2519699755125_CI")
Neutral_2<-read.table("results/R_results/5518873473655_CI")
Neutral_3<-read.table("results/R_results/5536135188855_CI")
Neutral_4<-read.table("results/R_results/5555300357555_CI")
Neutral_5<-read.table("results/R_results/5597604322855_CI")
Neutral_6<-read.table("results/R_results/5526691746355_CI")
Neutral_7<-read.table("results/R_results/5561122192855_CI")
Neutral_8<-read.table("results/R_results/5551393883655_CI")
Neutral_9<-read.table("results/R_results/5521073151055_CI")
Neutral_10<-read.table("results/R_results/5583941596055_CI")

Neutral_flp_1<-read.table("results/R_results/7502828106749_CI")
Neutral_flp_2<-read.table("results/R_results/1589041996747_CI")
Neutral_flp_3<-read.table("results/R_results/5385408036410_CI")
Neutral_flp_4<-read.table("results/R_results/6842444356530_CI")
Neutral_flp_5<-read.table("results/R_results/4621752902865_CI")
Neutral_flp_6<-read.table("results/R_results/3809137545526_CI")
Neutral_flp_7<-read.table("results/R_results/8081899648532_CI")
Neutral_flp_8<-read.table("results/R_results/2876069253310_CI")
Neutral_flp_9<-read.table("results/R_results/4280735488981_CI")
Neutral_flp_10<-read.table("results/R_results/1254488294944_CI")
Neutral_flp_11<-read.table("results/R_results/4698739288374_CI")

temp<-data.frame(envPop, rowMeans(data.frame(Neutral_1, Neutral_2, Neutral_3,Neutral_4, Neutral_5, Neutral_6, Neutral_7, Neutral_8, Neutral_9, Neutral_10)))
colnames(temp)<-c("Env",'CI_mean')
temp$CI_mean[3]-temp$CI_mean[1]
temp$CI_mean[10]-temp$CI_mean[8]

temp<-data.frame(envPop, rowMeans(data.frame(Neutral_flp_1, Neutral_flp_2, Neutral_flp_3,Neutral_flp_4, Neutral_flp_5, Neutral_flp_6, Neutral_flp_7, Neutral_flp_8, Neutral_flp_9, Neutral_flp_10)))
colnames(temp)<-c("Env",'CI_mean')
temp$CI_mean[3]-temp$CI_mean[1]
temp$CI_mean[10]-temp$CI_mean[8]

ggplot() + 
  geom_line(aes(x=Env_before, y=Neutral_1$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_2$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_3$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_4$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_5$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_6$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_7$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_8$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_9$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_10$V1, colour="a"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC1$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC2$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC3$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC4$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC5$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC6$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC7$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC8$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC9$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=All_equalC10$V1, colour="b"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_1$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_2$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_3$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_4$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_5$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_6$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_7$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_8$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_9$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_10$V1, colour="c"), lwd=1.5) +
  geom_line(aes(x=Env_before, y=Neutral_flp_11$V1, colour="c"), lwd=1.5) +
  #facet_grid(. ~ strSel) +
  labs(y="GF Cumulative Importance", x="Environment") +
  #geom_line(data=cImpMAF.neut, aes(x=x, y=y),
  #          colour=rgb(0,0,1, 0.75), lwd=1) +
  #geom_line(data=cImpMAF.sel, aes(x=x, y=y),
  #          colour=rgb(1,0,0, 0.75), lwd=1) +
  #geom_line(data=cImpMAF, aes(x=x, y=y),
  #          colour=rgb(0,0,0, 0.75), lwd=1) +
  theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 18, colour = "grey60"),
        axis.title.x = element_text(size=24)) +
  theme(axis.text.y = element_text(size = 16, colour = "grey60"),
        axis.title.y = element_text(size=24, vjust=1)) +
  scale_colour_manual(values=c("a"="lightblue","b"="grey","c"="orange"),labels = c("Increasing N", "All equal", "Decreasing N"),name="Model")+
  #  values=c(rgb(1,0,0,0.4),rgb(0,1,0,0.4),rgb(0,0,0,0.4),rgb(0,0,1,0.4),rgb(0.4,0,0,0.4))) +
  theme(plot.title = element_text(size=14, face="bold.italic"))+
  theme(legend.text=element_text(size=14), legend.title = element_text(size=14))

#For neutral simulation
plot(fit$Gen,fit$P19_env,type="l", main=plotTitle, xlab="Generations",ylab="Environmental variable",col="white",ylim=c(-1,5))
k=1
for(i in which(fitt$Type=="Env")){
  lines(fit$Gen,fit[,i+17],lwd=2,col=colfunc(10)[k])
  k=k+1
}


plot(fit$Gen,fit$P19_fit,type="l",main=plotTitle ,xlab="Generations",ylab="Relative Fitness",col="red")
x=1:10
y=1:10
for(i in x){
  for(j in y){
    k=((i - 1) + (j - 1) * 10 + 18)
    lines(fit$Gen,fit[,k],col=colfunc(10)[i])
  }
}

plot(fit$Gen,fit$P19_freq,type="l", main=plotTitle, xlab="Generations",ylab="Mutant allele frequency",col="red",ylim=c(0,1))
x=1:10
y=1:10
for(i in x){
  for(j in y){
    k=((i - 1) + (j - 1) * 10 + 118)
    lines(fit$Gen,fit[,k],col=colfunc(10)[i])
  }
}

ggplot() + 
  geom_line(aes(x=envPop$envSelect, y=gfTrans1$C.Imp_genome_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
  labs(y="GF Cumulative Importance", x="Environment") +
  theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 18, colour = "grey60"),
        axis.title.x = element_text(size=24)) +
  theme(axis.text.y = element_text(size = 16, colour = "grey60"),
        axis.title.y = element_text(size=24, vjust=1)) +
  theme(strip.text = element_text(size=16)) +
  ggtitle(plotTitle) +
  theme(plot.title = element_text(size=14, face="bold.italic"))

#For neutral simulation, plot deme size vs GF Offset
#All equal
Summary_Pop1n <- read.csv(file = "results/R_results/1278335993644_summary_Pop.csv")
Summary_Pop2n <- read.csv(file = "results/R_results/3393663285300_summary_Pop.csv")
Summary_Pop3n <- read.csv(file = "results/R_results/2207643041387_summary_Pop.csv")
Summary_Pop4n <- read.csv(file = "results/R_results/6359250998124_summary_Pop.csv")
Summary_Pop5n <- read.csv(file = "results/R_results/1940819310024_summary_Pop.csv")
Summary_Pop6n <- read.csv(file = "results/R_results/6040998529642_summary_Pop.csv")
Summary_Pop7n <- read.csv(file = "results/R_results/6417941976338_summary_Pop.csv")
Summary_Pop8n <- read.csv(file = "results/R_results/3323115928098_summary_Pop.csv")
Summary_Pop9n <- read.csv(file = "results/R_results/6232745500281_summary_Pop.csv")
Summary_Pop10n <- read.csv(file = "results/R_results/5643197868019_summary_Pop.csv")
Summary_Pop11n <- read.csv(file = "results/R_results/1540759557858_summary_Pop.csv")

AE <- list(Summary_Pop1n,Summary_Pop2n,Summary_Pop3n,Summary_Pop4n,Summary_Pop5n,Summary_Pop6n,Summary_Pop7n,Summary_Pop8n,Summary_Pop9n,Summary_Pop10n)#,Summary_Pop11n)

#Neutral
Summary_Pop1 <- read.csv(file = "results/R_results/2519699755125_summary_Pop.csv")
Summary_Pop2 <- read.csv(file = "results/R_results/5518873473655_summary_Pop.csv")
Summary_Pop3 <- read.csv(file = "results/R_results/5536135188855_summary_Pop.csv")
Summary_Pop4 <- read.csv(file = "results/R_results/5555300357555_summary_Pop.csv")
Summary_Pop5 <- read.csv(file = "results/R_results/5597604322855_summary_Pop.csv")
Summary_Pop6 <- read.csv(file = "results/R_results/5526691746355_summary_Pop.csv")
Summary_Pop7 <- read.csv(file = "results/R_results/5561122192855_summary_Pop.csv")
Summary_Pop8 <- read.csv(file = "results/R_results/5551393883655_summary_Pop.csv")
Summary_Pop9 <- read.csv(file = "results/R_results/5521073151055_summary_Pop.csv")
Summary_Pop10 <- read.csv(file = "results/R_results/5583941596055_summary_Pop.csv")

Neu <- list(Summary_Pop1,Summary_Pop2,Summary_Pop3,Summary_Pop4,Summary_Pop5,Summary_Pop6,Summary_Pop7,Summary_Pop8,Summary_Pop9,Summary_Pop10)

#Neutral_flipped:
Summary_Pop1f <- read.csv(file = "results/R_results/7502828106749_summary_Pop.csv")
Summary_Pop2f <- read.csv(file = "results/R_results/1589041996747_summary_Pop.csv")
Summary_Pop3f <- read.csv(file = "results/R_results/5385408036410_summary_Pop.csv")
Summary_Pop4f <- read.csv(file = "results/R_results/6842444356530_summary_Pop.csv")
Summary_Pop5f <- read.csv(file = "results/R_results/4621752902865_summary_Pop.csv")
Summary_Pop6f <- read.csv(file = "results/R_results/3809137545526_summary_Pop.csv")
Summary_Pop7f <- read.csv(file = "results/R_results/8081899648532_summary_Pop.csv")
Summary_Pop8f <- read.csv(file = "results/R_results/2876069253310_summary_Pop.csv")
Summary_Pop9f <- read.csv(file = "results/R_results/4280735488981_summary_Pop.csv")
Summary_Pop10f <- read.csv(file = "results/R_results/1254488294944_summary_Pop.csv")
Summary_Pop11f <- read.csv(file = "results/R_results/4698739288374_summary_Pop.csv")

Neu_flp <- list(Summary_Pop1f,Summary_Pop2f,Summary_Pop3f,Summary_Pop4f,Summary_Pop5f,Summary_Pop6f,Summary_Pop7f,Summary_Pop8f,Summary_Pop9f,Summary_Pop10f)

colfunc<-colorRampPalette(c("orange","cyan"))

# Neutral_1<-read.table("results/R_results/2519699755125_CI")
# Summary_Pop <- read.csv(file = "results/R_results/2519699755125_summary_Pop.csv")

# A <- 
# ggplot() + 
#   geom_line(aes(x=rep(1:10,10), y=Summary_Pop1$C.Imp_genome_before), colour=rgb(0,0,0,0.4), lwd=1.5) +
#   labs(y="GF Cumulative Importance", x="X-Location") +
#   scale_x_continuous(breaks=c(1:10))+
#   #theme(plot.margin = unit(c(1.25,1.25,1.25,1.25), "in")) +
#   theme_bw() +
#   theme(axis.text.x = element_text(size = 18, colour = "grey60"),
#         axis.title.x = element_text(size=24)) +
#   theme(axis.text.y = element_text(size = 16, colour = "grey60"),
#         axis.title.y = element_text(size=24, vjust=1)) +
#   theme(strip.text = element_text(size=16)) +
#   theme(plot.title = element_text(size=14, face="bold.italic"))

#popsum <- Summary_Pop[1:10,]
# GF_Offset <- NULL
# ref <- seq(1,9,2)
# count <- 1
# while(count<5){
#   GF_Offset <- c(GF_Offset,popsum$C.Imp_genome_before[ref[count+1]]-popsum$C.Imp_genome_before[ref[count]])
#   count=count+1
# }

GF_Offset_AE <- NULL

for(i in AE){
  ref <- seq(1,10,1)
  
  popsum1 <- i[1:10,]
  
  count <- 1
  
  while(count<10){
    GF_Offset_AE <- c(GF_Offset_AE,popsum1$C.Imp_genome_before[ref[count+1]]-popsum1$C.Imp_genome_before[ref[count]])
    count=count+1
  }
}

GF_Offset_Neu <- NULL

for(i in Neu){
  ref <- seq(1,10,1)
  
  popsum1 <- i[1:10,]
  
  count <- 1
  
  while(count<10){
    GF_Offset_Neu <- c(GF_Offset_Neu,popsum1$C.Imp_genome_before[ref[count+1]]-popsum1$C.Imp_genome_before[ref[count]])
    count=count+1
  }
}

GF_Offset_Neu_flp <- NULL

for(i in Neu_flp){
  ref <- seq(1,10,1)
  
  popsum1 <- i[1:10,]
  
  count <- 1
  
  while(count<10){
    GF_Offset_Neu_flp <- c(GF_Offset_Neu_flp,popsum1$C.Imp_genome_before[ref[count+1]]-popsum1$C.Imp_genome_before[ref[count]])
    count=count+1
  }
}

# popsum1 <- Summary_Pop1[1:10,]
# GF_Offset1 <- NULL
# count <- 1
# while(count<10){
#     GF_Offset1 <- c(GF_Offset1,popsum1$C.Imp_genome_before[ref[count+1]]-popsum1$C.Imp_genome_before[ref[count]])
#     count=count+1
# }
# 
# popsum2 <- Summary_Pop2[1:10,]
# GF_Offset2 <- NULL
# count <- 1
# while(count<10){
#   GF_Offset2 <- c(GF_Offset2,popsum2$C.Imp_genome_before[ref[count+1]]-popsum2$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# popsum3 <- Summary_Pop3[1:10,]
# GF_Offset3 <- NULL
# count <- 1
# while(count<10){
#   GF_Offset3 <- c(GF_Offset3,popsum3$C.Imp_genome_before[ref[count+1]]-popsum3$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# #comp<-c("1-3","3-5","5-7","7-9")
# Comp<-c("1-2","2-3","3-4","4-5","5-6","6-7","7-8","8-9","9-10")
# GFoff1 <- data.frame(Comp, GF_Offset1)
# GFoff2 <- data.frame(Comp, GF_Offset2)
# GFoff3 <- data.frame(Comp, GF_Offset3)

# B <- ggplot(data=GFoff, aes(x=comp, y=GF_Offset))
#   geom_bar(stat="identity")+
#   labs(y="GF Offset", x="Comparison")+
#   theme_classic() +
#   theme(axis.text.x = element_text(size = 18, colour = "grey60"),
#         axis.title.x = element_text(size=24)) +
#   theme(axis.text.y = element_text(size = 16, colour = "grey60"),
#         axis.title.y = element_text(size=24, vjust=1)) +
#   theme(strip.text = element_text(size=16)) +
#   theme(plot.title = element_text(size=14, face="bold.italic"))
#barplot(GF_Offset)

#plot_grid(A,B,nrow=2,align="v",rel_heights=c(2,1),rel_widths = c(1,2))

Size <- Summary_Pop1$Pop_size[1:9]
Comp<-c("1-2","2-3","3-4","4-5","5-6","6-7","7-8","8-9","9-10")
Rep <- rep(LETTERS[1:10],each=9)
GF_Off <- data.frame(Rep=Rep,Comp=rep(Comp,10),Size=rep(Size,10),GF_Off=GF_Offset_Neu)
#GF_Off <- data.frame(Rep="A", Comp=GFoff1$Comp, Size=Size, GF_Off=GFoff1$GF_Offset1)
#GF_Off <- rbind(GF_Off, data.frame(Rep="B", Comp=GFoff2$Comp, Size=Size, GF_Off=GFoff2$GF_Offset2))
#GF_Off <- rbind(GF_Off, data.frame(Rep="C", Comp=GFoff3$Comp, Size=Size, GF_Off=GFoff3$GF_Offset3))
options(scipen = 0)
#Comp_size <- data.frame(Size, GF_Off)
rho_test<-cor.test(GF_Off$GF_Off,GF_Off$Size, method = "pearson")
LH <-ggplot(data=GF_Off)+
  geom_point(aes(x=GF_Off,y=Size,color=Comp),size=4)+
  ylab("Deme size")+
  xlab(expression(paste("\n")))+
  #scale_colour_gradientn(colours = colfunc(9))+
  scale_colour_manual(values = colfunc(9))+
  theme_classic(base_size = 16)+
  ylim(10,200)+
  xlim(0,0.04)+
  theme(legend.position = "none")+
  ggtitle("Low to High")+
  geom_smooth(aes(x=GF_Off,y=Size),method='lm',col="red",size=1,se=F)+
  theme(axis.text.x = element_text(size = 18),
        axis.title.x = element_text(size=24)) +
  theme(axis.text.y = element_text(size = 16),
        axis.title.y = element_text(size=24, vjust=1)) +
  theme(plot.title = element_text(size=24, face="bold.italic"))+
  annotate("text", size=6, x = max(GF_Off$GF_Off)+0.005, y = max(GF_Off$Size)-50, label = paste("r = ",round(rho_test$estimate,3), "\np-value = ",round(rho_test$p.value,7), sep=""))


# popsum1f <- Summary_Pop1f[1:10,]
# GF_Offset1f <- NULL
# count <- 1
# while(count<10){
#   GF_Offset1f <- c(GF_Offset1f,popsum1f$C.Imp_genome_before[ref[count+1]]-popsum1f$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# popsum2f <- Summary_Pop2f[1:10,]
# GF_Offset2f <- NULL
# count <- 1
# while(count<10){
#   GF_Offset2f <- c(GF_Offset2f,popsum2f$C.Imp_genome_before[ref[count+1]]-popsum2f$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# popsum3f <- Summary_Pop3f[1:10,]
# GF_Offset3f <- NULL
# count <- 1
# while(count<10){
#   GF_Offset3f <- c(GF_Offset3f,popsum3f$C.Imp_genome_before[ref[count+1]]-popsum3f$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# #comp<-c("1-3","3-5","5-7","7-9")
# Comp<-c("1-2","2-3","3-4","4-5","5-6","6-7","7-8","8-9","9-10")
# GFoff1f <- data.frame(Comp, GF_Offset1f)
# GFoff2f <- data.frame(Comp, GF_Offset2f)
# GFoff3f <- data.frame(Comp, GF_Offset3f)
# 
# Size <- popsum1f$Pop_size[1:9]
# 
# GF_Off2 <- data.frame(Rep="A", Comp=GFoff1f$Comp, Size=Size, GF_Off=GFoff1f$GF_Offset1f)
# GF_Off2 <- rbind(GF_Off2, data.frame(Rep="B", Comp=GFoff2f$Comp, Size=Size, GF_Off=GFoff2f$GF_Offset2f))
# GF_Off2 <- rbind(GF_Off2, data.frame(Rep="C", Comp=GFoff3f$Comp, Size=Size, GF_Off=GFoff3f$GF_Offset3f))

Size2 <- Summary_Pop1f$Pop_size[1:9]
GF_Off2 <- data.frame(Rep=Rep,Comp=rep(Comp,10),Size=rep(Size2,10),GF_Off=GF_Offset_Neu_flp)
rho_test<-cor.test(GF_Off2$GF_Off,GF_Off2$Size, method = "pearson")
HL <-ggplot(data=GF_Off2)+
  geom_point(aes(x=GF_Off,y=Size,color=Comp),size=4)+
  ylab("")+
  xlab(expression(paste("GF Offset")))+
  #scale_colour_gradientn(colours = colfunc(9))+
  scale_colour_manual(values = colfunc(9))+
  theme_classic(base_size = 16)+
  ylim(10,200)+
  xlim(0,0.04)+
  #theme(legend.position = "none")+
  ggtitle("High to Low")+
  theme(axis.text.y = element_blank(),
       axis.ticks.y = element_blank())+
  geom_smooth(aes(x=GF_Off,y=Size),method='lm',col="red",size=1,se=F)+
  annotate("text", x = max(GF_Off$GF_Off)+0.005, y = max(GF_Off$Size)-50, label = paste("r = ",round(rho_test$estimate,3), "\np-value = ",round(rho_test$p.value,28), sep=""))

# popsum1n <- Summary_Pop1n[1:10,]
# GF_Offset1n <- NULL
# count <- 1
# while(count<10){
#   GF_Offset1n <- c(GF_Offset1n,popsum1n$C.Imp_genome_before[ref[count+1]]-popsum1n$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# popsum2n <- Summary_Pop2n[1:10,]
# GF_Offset2n <- NULL
# count <- 1
# while(count<10){
#   GF_Offset2n <- c(GF_Offset2n,popsum2n$C.Imp_genome_before[ref[count+1]]-popsum2n$C.Imp_genome_before[ref[count]])
#   count=count+1
# }
# 
# popsum3n <- Summary_Pop3n[1:10,]
# GF_Offset3n <- NULL
# count <- 1
# while(count<10){
#   GF_Offset3n <- c(GF_Offset3n,popsum3n$C.Imp_genome_before[ref[count+1]]-popsum3n$C.Imp_genome_before[ref[count]])
#   count=count+1
# }

#comp<-c("1-3","3-5","5-7","7-9")
# Comp<-c("1-2","2-3","3-4","4-5","5-6","6-7","7-8","8-9","9-10")
# GFoff1n <- data.frame(Comp, GF_Offset1n)
# GFoff2n <- data.frame(Comp, GF_Offset2n)
# GFoff3n <- data.frame(Comp, GF_Offset3n)
# 
# Size <- popsum1n$Pop_size[1:9]
# 
# GF_Off3 <- data.frame(Rep="A", Comp=GFoff1n$Comp, Size=Size, GF_Off=GFoff1n$GF_Offset1n)
# GF_Off3 <- rbind(GF_Off3, data.frame(Rep="B", Comp=GFoff2n$Comp, Size=Size, GF_Off=GFoff2n$GF_Offset2n))
# GF_Off3 <- rbind(GF_Off3, data.frame(Rep="C", Comp=GFoff3n$Comp, Size=Size, GF_Off=GFoff3n$GF_Offset3n))

Size3 <- Summary_Pop1n$Pop_size[1:9]
GF_Off3 <- data.frame(Rep=Rep,Comp=rep(Comp,10),Size=rep(Size3,10),GF_Off=GF_Offset_AE)

N <- ggplot(data=GF_Off3)+
  geom_point(aes(x=GF_Off,y=Size,color=Comp),size=4)+
  ylab("")+
  xlab(expression(paste("\n")))+
  #scale_colour_gradientn(colours = colfunc(9))+
  scale_colour_manual(values = colfunc(9))+
  theme_classic(base_size = 16)+
  ylim(10,200)+
  #theme(legend.position = "none")+
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank())+
  ggtitle("Equal")+
  geom_smooth(aes(x=GF_Off,y=Size),method='lm',col="red",size=1,se=F)

#plot_grid(LH,HL,N,ncol=3,rel_widths = c(1,1,1.25))

plot_grid(LH,HL,ncol=2,rel_widths = c(1,1.25))

#rho_test<-cor.test(Comp_size$GF_Offset,Comp_size$Size, method = "pearson" )
# B <-ggplot(data=Comp_size,aes(x=GF_Offset,y=Size,color=Size,size=2))+
#   geom_point()+
#   ylab("Deme size")+
#   xlab(expression(paste("GF Gen offset Genome")))+
#   scale_colour_gradientn(colours = colfunc(9))+
#   theme_classic(base_size = 16)+
#   #ylim(10,220)+
#   theme(legend.position = "none")+
#   geom_smooth(method='lm',col="red",size=1,se=F)+
#   annotate("text", x = max(Comp_size$GF_Offset)-0.005, y = max(Comp_size$Size)-50, label = paste("r = ",round(rho_test$estimate,3), "\np-value = ",round(rho_test$p.value,7), sep=""))
# 
# plot_grid(A,B,nrow=2)
