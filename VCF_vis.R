setwd("/FFF_indPop_output/")

library(vcfR)
library(pinfsc50)
library(reshape2)
library(ggplot2)
library(dplyr)

P1<-read.vcfR("FFF.p1.vcf")
P1_MAF<-maf(P1, element=1) #Major allele frequency
P1_maf<-maf(P1, element=2) #Minor allele frequency

P4<-read.vcfR("FFF.p4.vcf")
P4_MAF<-maf(P4, element=1) #Major allele frequency
P4_maf<-maf(P4, element=2) #Minor allele frequency

head(P1_maf)
head(P4_maf)
tail(P1_maf)
tail(P4_maf)
#gt<-extract.gt(P1)

queryMETA(P4)


P1_maf<-cbind(row.names(P1_maf),P1_maf)
colnames(P1_maf)[1]<-"ID"
P4_maf<-cbind(row.names(P4_maf),P4_maf)
colnames(P4_maf)[1]<-"ID"

x<-merge(P1_maf[,c("ID","Frequency")],P4_maf[,c("ID","Frequency")],by="ID",suffixes=c("P1","P2"), all=T)


x<-read.table("FFF.p1.frq", fill=T, header=F, row.names = NULL)
x<-x[-1,-c(1,3,4)]
colnames(x)<-c("POS","A1","A2")
x$A1<-as.numeric(gsub("[A-Z]:","",x$A1))
x$A2<-as.numeric(gsub("[A-Z]:","",x$A2))
